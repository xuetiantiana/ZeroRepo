import{i as v}from"./index-CVOXnaBf.js";import{_ as $,q as z,s as w,o as B,c as C,p as D,f as A,a as y}from"./index-D2X4RJqq.js";const I=g=>(D("data-v-3a585f2f"),g=g(),A(),g),O={class:""},E=I(()=>y("div",{class:"header"},[y("h3",null,"echart"),y("div",{id:"viewport"},[y("div",{id:"wrapper"},[y("div",{id:"echart",style:{width:"100%",height:"100%"}})])])],-1)),k=[E],x={__name:"echart2",setup(g){let S=null;z(()=>{const e=document.getElementById("echart");if(!e)return;const o=v(e);fetch("./data/webui.json").then(n=>n.json()).then(n=>{b(n),p(o)}),w(()=>{o.dispose()})});const _=(e,o="root",n="",t=0)=>{const l=n?"".concat(n,"/").concat(o):o;if(Array.isArray(e))return e.map(i=>{const r=t+1;return{name:i,feature_path:"".concat(l,"/").concat(i),level:r,symbolSize:f(r),label:d(r),itemStyle:m(r),lineStyle:h(r)}});if(typeof e=="object"&&e!==null){const i=[];for(const[r,s]of Object.entries(e))if(Array.isArray(s))i.push({name:r,feature_path:"".concat(l,"/").concat(r),level:t,symbolSize:f(t),label:d(t),itemStyle:m(t),lineStyle:h(t),children:s.map(c=>{const u=t+1;return{name:c,feature_path:"".concat(l,"/").concat(r,"/").concat(c),level:u,symbolSize:f(u),label:d(u),itemStyle:m(u),lineStyle:h(u)}})});else if(typeof s=="object"){const c=_(s,r,l,t+1);Array.isArray(c)?i.push({name:r,feature_path:"".concat(l,"/").concat(r),level:t,symbolSize:f(t),label:d(t),itemStyle:m(t),lineStyle:h(t),children:c}):i.push({name:r,feature_path:"".concat(l,"/").concat(r),level:t,symbolSize:f(t),label:d(t),itemStyle:m(t),lineStyle:h(t),children:c.children||[]})}return i}return{name:e,feature_path:l}},b=e=>{if(e&&e.subtrees&&e.subtrees.length>0){const o=[];e.subtrees.forEach((t,l)=>{if(t.refactored_subtree){const i=t.name||"Subtree_".concat(l+1),r=_(t.refactored_subtree,i,"",2),s={name:i,feature_path:"".concat(t.file_path||i),level:1,symbolSize:f(1),label:d(1),itemStyle:m(1),lineStyle:h(1),children:r};o.push(s)}});const n={name:"root",feature_path:"root",level:0,symbolSize:f(0),label:d(0),itemStyle:m(0),lineStyle:h(0),children:o};return console.log("!!!!",o),console.log("数据转换完成:",n),console.log("处理了 ".concat(o.length," 个subtree组")),S=n,n}return console.warn("数据格式不正确，使用默认数据"),e},a=["#686759","#B04B35","#E37C05","#5F9DBF","#568651","#B89C80"],f=e=>{let o;return e==0?o=5:e==1?o=50:e<=4?o=30:o=3,o},m=e=>e<=1?{color:a[e%a.length],borderColor:a[e%a.length],borderWidth:.5}:{color:a[e%a.length],borderColor:a[e%a.length],borderWidth:.5},h=e=>({color:a[e%a.length],width:.5}),d=e=>{let o={};return e>=5||e==0?o={fontSize:(e==5,10),color:(e>=5,"#333"),fontWeight:e===1?"bold":"normal"}:o={position:"inside",fontSize:(e==5,10),color:(e>=5,"#333"),verticalAlign:"middle",align:"center",fontWeight:e===1?"bold":"normal",width:100},o},p=e=>{var o={tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"tree",roam:!0,data:[S],top:"0%",bottom:"0%",layout:"radial",symbol:"circle",symbolSize:30,initialTreeDepth:6,animationDurationUpdate:750,emphasis:{focus:"descendant"},label:{show:!0,overflow:"break",formatter:function(n){console.log(n,n.level);var t=n.name||"";if(n.data.level>=5)return t;for(var l=t.split(" "),i=[],r=0;r<l.length;r++){var s=l[r];if(s.indexOf("-")!==-1)for(var c=s.split("-"),u=0;u<c.length;u++)i.push(c[u]),u<c.length-1&&i.push("-");else i.push(s)}return i.join("\n")}},tooltip:{trigger:"item",triggerOn:"mousemove",formatter:function(n){const t=n.data;let l="";return t&&t.name&&(l+="<strong>节点名称:</strong> ".concat(t.name,"<br/>"),t.feature_path&&(l+="<strong>路径:</strong> ".concat(t.feature_path))),l||n.name||""}},lineStyle:{curveness:0},labelLayout:{hideOverlap:!0}}]};e.setOption(o)};return(e,o)=>(B(),C("div",O,k))}},T=$(x,[["__scopeId","data-v-3a585f2f"]]);export{T as default};
