!function(){function e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}}}function t(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){d=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw r}}return l}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}System.register(["./util-legacy-BQ9sUvNq.js","./index-legacy-CU-dtc80.js","./index-legacy-Ds2O1RuX.js"],(function(n,r){"use strict";var i,l,d,s,u,f,p,v,b,h,g,m,y,x,w,k,N,S,C,_,j,A,O,T,M,I;return{setters:[function(e){i=e.h,l=e.g},function(e){d=e.d,s=e.r,u=e.o,f=e.c,p=e.a,v=e.t,b=e.F,h=e.b,g=e.e,m=e.n,y=e.p,x=e.f,w=e._,k=e.g,N=e.h,S=e.i,C=e.j,_=e.w,j=e.k,A=e.l,O=e.m,T=e.q,M=e.s},function(e){I=e.i}],execute:function(){var r=document.createElement("style");r.textContent='@charset "UTF-8";.body .show[data-v-ae8090cc]{z-index:1000;opacity:1;pointer-events:auto}.body .info-item[data-v-ae8090cc]{margin-bottom:8px;overflow-wrap:break-word;word-wrap:break-word}.body .info-item .info-label[data-v-ae8090cc]{font-weight:700;color:#555}.body .info-item .info-value[data-v-ae8090cc]{margin-left:10px;color:#333}.body .info-docstring .docstring-content[data-v-ae8090cc]{cursor:pointer;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;transition:all .3s ease}.body .info-docstring.expanded .docstring-content[data-v-ae8090cc]{display:block;-webkit-line-clamp:unset;overflow:visible}.body .info-docstring.expanded .docstring-content[data-v-ae8090cc]:hover{color:#000}.sidebar[data-v-b60eba41]{font-size:14px;height:100%;width:100%;background:#f8f9fa;border-right:2px solid #dee2e6;overflow:hidden;padding:0;box-sizing:border-box;display:flex;flex-direction:column}.sidebar .sidebar-header[data-v-b60eba41]{display:flex;flex-direction:row;justify-content:space-between;padding:.8em 1em;border-bottom:4px solid #dee2e6}.sidebar .sidebar-content[data-v-b60eba41]{flex:1;overflow:hidden;display:flex;flex-direction:column}.sidebar .sidebar-content .current-node-box[data-v-b60eba41]{min-height:200px;padding:1em}.sidebar .sidebar-content .selected-nodes-box[data-v-b60eba41]{padding:1em 0;flex:1;overflow:hidden}.sidebar .sidebar-content .selected-nodes-box>div[data-v-b60eba41]{padding:0 1em;height:100%;overflow-y:auto}.select-node-item[data-v-b60eba41]{width:100%;background:#fff;border:2px solid #ccc;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,.3);transition:opacity .3s ease-in-out;margin-top:1em}.select-node-item[data-v-b60eba41]:nth-child(1){margin-top:0}.select-node-item .show[data-v-b60eba41]{z-index:1000;opacity:1;pointer-events:auto}.select-node-item .node-header[data-v-b60eba41]{background:#f5f5f5;padding:15px;border-bottom:1px solid #ddd;border-radius:6px 6px 0 0;position:relative}.select-node-item .node-header h3[data-v-b60eba41]{cursor:pointer}.select-node-item .node-title[data-v-b60eba41]{margin:0;font-weight:700;color:#333;font-size:1.1em;padding-right:1em}.select-node-item .close-btn[data-v-b60eba41]{position:absolute;right:5px;top:10px;background:none;border:none;font-size:20px;cursor:pointer;color:#666;width:30px;height:30px;border-radius:15px}.select-node-item .close-btn[data-v-b60eba41]:hover{background:#e0e0e0;color:#000}.select-node-item .node-body[data-v-b60eba41]{padding:15px;max-height:200px;min-height:100px;overflow-y:auto}[data-v-b60eba41] .el-radio-group{border-radius:20px;padding:3px 4px;background:#ccc;gap:5px;--el-font-size-base: 18px}[data-v-b60eba41] .el-radio-group .el-radio-button__inner{border:0!important;border-radius:20px!important;color:#fff;background:transparent}[data-v-b60eba41] .el-radio-group .is-active .el-radio-button__inner{background:#000!important;color:#fff!important;box-shadow:inset 0 0 0 1px #000!important}.plus-button[data-v-b60eba41]{position:absolute;width:20px;height:20px;top:25px;right:-5px;background-color:#409eff;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;cursor:pointer;z-index:1000;box-shadow:0 2px 8px rgba(0,0,0,.3);transition:all .2s ease;user-select:none;transform:translate(-50%,-50%)}.plus-button span[data-v-b60eba41]{line-height:1;transform:translateY(-1px)}.plus-button[data-v-b60eba41]:hover{box-shadow:0 4px 12px rgba(0,0,0,.4)}.plus-button:hover[style*="background-color: rgb(64, 158, 255)"][data-v-b60eba41]{background-color:#66b1ff!important}.plus-button:hover[style*="background-color: rgb(245, 108, 108)"][data-v-b60eba41]{background-color:#f78989!important}.plus-button:hover[style*="background-color: rgb(144, 147, 153)"][data-v-b60eba41]{background-color:#a6a9ad!important}.header h3[data-v-c62e54a2]{margin:10px 0;text-align:center}.control-panel[data-v-c62e54a2]{display:flex;align-items:center;gap:20px;padding:10px 20px;background:#f8f9fa;border-radius:8px;margin:0 20px 10px;border:1px solid #e9ecef}.control-item[data-v-c62e54a2]{display:flex;align-items:center;gap:8px}.control-item label[data-v-c62e54a2]{font-size:14px;color:#333;font-weight:500}.max-nodes-input[data-v-c62e54a2]{width:60px;padding:4px 8px;border:1px solid #ddd;border-radius:4px;font-size:14px;text-align:center}.max-nodes-input[data-v-c62e54a2]:focus{outline:none;border-color:#409eff;box-shadow:0 0 0 2px rgba(64,158,255,.2)}.selection-status[data-v-c62e54a2]{font-size:14px;color:#666}.status-full[data-v-c62e54a2]{color:#f56c6c;font-weight:500}#viewport[data-v-c62e54a2]{width:100vw;height:100vh;overflow:hidden;position:relative}#wrapper[data-v-c62e54a2],#echart[data-v-c62e54a2]{width:100%;height:100%}.plus-button[data-v-c62e54a2]{position:absolute;width:20px;height:20px;background-color:#409eff;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;cursor:pointer;z-index:1000;box-shadow:0 2px 8px rgba(0,0,0,.3);transition:all .2s ease;user-select:none;transform:translate(-50%,-50%)}.plus-button span[data-v-c62e54a2]{line-height:1;transform:translateY(-1px)}.plus-button[data-v-c62e54a2]:hover{box-shadow:0 4px 12px rgba(0,0,0,.4)}.plus-button:hover[style*="background-color: rgb(64, 158, 255)"][data-v-c62e54a2]{background-color:#66b1ff!important}.plus-button:hover[style*="background-color: rgb(245, 108, 108)"][data-v-c62e54a2]{background-color:#f78989!important}.plus-button:hover[style*="background-color: rgb(144, 147, 153)"][data-v-c62e54a2]{background-color:#a6a9ad!important}#wrapper[data-v-c62e54a2]{position:relative}.center-view-btn[data-v-c62e54a2]{background:#fff;color:#2b7ce9;border:1px solid rgb(43,124,233)}.center-view-btn[data-v-c62e54a2]:hover{opacity:.8}\n',document.head.appendChild(r);var z=function(e){return y("data-v-ae8090cc"),e=e(),x(),e},E={key:0,class:"body"},P={class:"info-item"},D=z((function(){return p("span",{class:"info-label"},"Node:",-1)})),B={class:"info-value"},F={class:"info-item"},L=z((function(){return p("span",{class:"info-label"},"Feature Path:",-1)})),R={class:"info-value"},q={key:0,class:"info-file_pat_"},W={class:"info-label"},U={class:"info-value"},G={key:0,style:{"margin-top":"0.5em"}},V=["onClick"],H={key:1},Y={key:2,style:{"margin-top":"0.5em"}},X=z((function(){return p("b",{style:{"margin-top":"0.5em"}},"methods: ",-1)})),Z={key:0,class:"info-file_pat_"},$={class:"info-label"},J={class:"info-value"},K={class:"info-label"},Q=["onClick"],ee=w(d({__name:"nodeDetailComponent",props:{currNode:{type:Object,required:!0,default:function(){return{}}}},setup:function(e){var t=s(new Set),n=function(e){t.value.has(e)?t.value.delete(e):t.value.add(e)},o=function(e){return t.value.has(e)};return function(t,r){return e.currNode&&e.currNode.metaData?(u(),f("div",E,[p("div",P,[D,p("span",B,v(e.currNode.metaData.node),1)]),p("div",F,[L,p("span",R,v(e.currNode.metaData.feature_path),1)]),(u(!0),f(b,null,h(e.currNode.metaData.file_paths,(function(e,t){return u(),f("div",{key:t,class:"info-item"},[(u(!0),f(b,null,h(e,(function(e,t,n){return u(),f(b,{key:n},["extra"!==t?(u(),f("div",q,[p("span",W,v(t)+":",1),p("span",U,v(e),1)])):g("",!0)],64)})),128)),e.extra?(u(),f("div",G,[(u(!0),f(b,null,h(e.extra,(function(e,r,a){return u(),f(b,{key:a},["docstring"==r?(u(),f("div",{key:0,class:m(["info-docstring",{expanded:o("".concat(t,"-").concat(r))}])},[p("b",null,v(r)+": ",1),p("span",{class:"docstring-content",onClick:function(e){return n("".concat(t,"-").concat(r))}},v(e),9,V)],2)):"methods"!==r?(u(),f("p",H,[p("b",null,v(r)+": ",1),p("span",null,v(e),1)])):"methods"==r?(u(),f("div",Y,[X,(u(!0),f(b,null,h(e,(function(e,r){return u(),f("div",{key:r,style:{"margin-bottom":"0.5em"}},[(u(!0),f(b,null,h(e,(function(e,a,i){return u(),f(b,{key:i},["docstring"!==a?(u(),f("div",Z,[p("span",$,v(a)+":",1),p("span",J,v(e),1)])):"docstring"==a?(u(),f("div",{key:1,class:m(["info-docstring",{expanded:o("".concat(t,"-").concat(r,"-").concat(a))}])},[p("span",K,v(a)+":",1),p("span",{class:"docstring-content",onClick:function(e){return n("".concat(t,"-").concat(r,"-").concat(a))}},v(e),9,Q)],2)):g("",!0)],64)})),128))])})),128))])):g("",!0)],64)})),128))])):g("",!0)])})),128))])):g("",!0)}}}),[["__scopeId","data-v-ae8090cc"]]),te=function(e){return y("data-v-b60eba41"),e=e(),x(),e},ne={class:"sidebar"},oe=te((function(){return p("div",{class:"sidebar-header"},[p("h2",null,"ZeroRepo")],-1)})),re={class:"sidebar-content"},ae={class:"current-node-box",ref:"nodeModalRef"},ie={class:"select-node-item",style:{border:"2px solid #2b7ce9","box-shadow":"0 8px 24px rgba(43, 124, 233, 0.4)"}},le={class:"node-header"},ce={class:"node-title",style:{"margin-right":"12px"}},de=te((function(){return p("span",{style:{color:"#2b7ce9"}},"CurrNode:  ",-1)})),se={class:"icon"},ue={class:"node-body"},fe={style:{padding:"1em 1em 0","border-top":"1px solid #aaa","margin-top":"1em"}},pe={style:{margin:"0 0 1em"}},ve={class:"selected-nodes-box"},be=["onClick"],he=["onClick"],ge={class:"node-body"},me=w(d({__name:"SelectedNodesPanel",props:{selectedNodeList:{type:Array,required:!0,default:[]},currNode:{type:Object,required:!0,default:function(){return{}}},maxSelectedNodes:{type:Number,required:!0,default:0}},emits:["removeSelectedNode","clearAllSelectedNodes","handleSelectedNodeClick","handleCurrNodePlusClick"],setup:function(e,t){var n=t.expose,o=t.emit,r=e,a=o,i=function(){a("clearAllSelectedNodes"),l.value=""},l=s(""),d=s(null),m=s({});var y=function(e){null!=e&&j((function(){var t=m.value[e];t&&d.value&&t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}))};return n({handleNodeSearch:y}),function(t,n){var o=k("el-button"),s=k("el-option"),x=k("el-select");return u(),f("div",null,[p("div",ne,[oe,p("div",re,[p("div",ae,[p("div",ie,[p("div",le,[p("h3",ce,[de,N(" "+v(e.currNode&&"object"===c(e.currNode)&&Object.keys(e.currNode).length>0?e.currNode.hasAbbr?e.currNode.originalName+" ("+e.currNode.name+")":e.currNode.metaData.node:"节点信息"),1)]),e.currNode&&"object"===c(e.currNode)&&Object.keys(e.currNode).length>0?(u(),f("div",{key:0,class:"plus-button",onClick:n[0]||(n[0]=function(t){return n=e.currNode,void a("handleCurrNodePlusClick",n);var n})},[p("span",se,v(e.selectedNodeList.some((function(t){return t.idx===e.currNode.idx}))?"-":"+"),1)])):g("",!0)]),p("div",ue,[e.currNode&&e.currNode.metaData?(u(),S(ee,{key:0,currNode:e.currNode},null,8,["currNode"])):g("",!0)])])],512),p("div",fe,[p("h4",pe,[N(" Added Nodes ("+v(e.selectedNodeList.length)+") ",1),C(o,{size:"small",style:{float:"right"},onClick:i},{default:_((function(){return[N("Clear All")]})),_:1})]),C(x,{modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=function(e){return l.value=e}),filterable:"",placeholder:"Type to search yours added nodes below...",clearable:"",style:{width:"100%"},onChange:y},{default:_((function(){return[(u(!0),f(b,null,h(e.selectedNodeList,(function(e,t){var n;return u(),S(s,{key:e.id,label:(null===(n=e.metaData)||void 0===n?void 0:n.node)||e.label,value:t},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]),p("div",ve,[p("div",{ref_key:"selectedNodesScrollContainer",ref:d,class:"selected-nodes-list"},[(u(!0),f(b,null,h(e.selectedNodeList,(function(e,t){return u(),f("div",{key:t,ref_for:!0,ref:function(e){return function(e,t){e&&(m.value[t]=e)}(e,t)},class:"select-node-item"},[p("div",{class:"node-header",style:A({"border-left":"4px solid ".concat(e.selectedColor)})},[p("h3",{onClick:function(t){return n=e.idx,void a("handleSelectedNodeClick",n);var n},class:"node-title",style:A({color:e.selectedColor})},v(e.hasAbbr?e.originalName+" ("+e.name+")":e.metaData.node),13,be),p("button",{class:"close-btn",onClick:function(t){return n=e.idx,console.log(r.selectedNodeList),void a("removeSelectedNode",n);var n}}," × ",8,he)],4),p("div",ge,[e&&e.metaData?(u(),S(ee,{key:0,currNode:e},null,8,["currNode"])):g("",!0)])])})),128))],512)])])])])}}}),[["__scopeId","data-v-b60eba41"]]),ye=function(e){return y("data-v-c62e54a2"),e=e(),x(),e},xe={class:""},we={style:{height:"100vh"}},ke={id:"viewport",style:{display:"flex"}},Ne={id:"wrapper",style:{flex:"1",overflow:"hidden",height:"100%"}},Se=ye((function(){return p("div",{id:"echart",style:{width:"100%",height:"100%"}},null,-1)})),Ce=[ye((function(){return p("span",{class:"icon"},"+",-1)}))],_e={class:"showAllNodes",style:{position:"absolute",right:"20px",top:"5px","z-index":"1000"}},je={style:{position:"absolute",right:"150px",top:"5px","z-index":"1000"}},Ae={__name:"echart3",setup:function(n){var r=s(),c=null,d={nodes:[],links:[]},b=1,h=null,g=!1,m=null,y=null,x=s([]),w=s(1e6),S=s(),j=0,A=0,z=[];O(w,(function(e,t){if(console.log("最大选择数量从 ".concat(t," 变更为 ").concat(e)),x.value.length>e){var n=x.value.slice(e);x.value=x.value.slice(0,e),console.log("由于限制变更，移除了以下节点:",n),alert("由于限制变更，已移除 ".concat(n.length," 个节点"))}}));var E=1e3,P=1e3;T((function(){E=document.getElementById("echart").getBoundingClientRect().width,P=document.getElementById("echart").getBoundingClientRect().height;var e=Math.min(E,P);b=Math.max(2500/e,1),y=document.getElementById("plusButton"),pe(),console.log("屏幕尺寸：",E,P,2500/e,b);var t=document.getElementById("echart");t&&(h=I(t),Promise.all([fetch("./data/webui.json").then((function(e){return e.json()})),fetch("./data/map.json").then((function(e){return e.json()}))]).then((function(e){var t=a(e,2),n=t[0],o=t[1];console.log("webui:",n),console.log("map:",o),F(n.data_flow_graph);var r=i(n,o);c=r,J(1),d=$(c),K(h)})).catch((function(e){console.error("请求失败:",e)})),M((function(){h.dispose()})))}));var D=s(!1),B=[],F=function(e){e.forEach((function(e){var t=e.from,n=e.to;if(t&&n){var o={source:"1_"+t,target:"1_"+n,type:"rootLink",content:e,label:{show:!0,formatter:e.data_type||e.label||"",color:"#000",fontSize:9,position:"middle"},lineStyle:{color:"#000",width:1,type:"dashed",opacity:1},symbol:["circle","arrow"],symbolSize:[4,8]};B.push(o)}})),console.log(B)};var L,R,q=(R=[{name:"test1",x:L=680,y:L},{name:"test2",x:-L,y:-L},{name:"test3",x:-L,y:L},{name:"test4",x:L,y:-L}],console.log("Dddd"),R.map((function(e){return o(o({},e),{},{id:e.name,itemStyle:{opacity:0},label:{show:!1}})}))),W=["#686759","#0068B8","#62BDE4","#52E0FC","#86DCF8","#BAD7F3"],U={"Advanced Modeling Techniques":"#FF8364",Algorithms:"#5414E9",Workflow:"#00C6A2","Data Engineering":"#0368FF"},G=function(e){return 0==e?5:1==e?100/b:2==e?80/b:3==e?70/b:4==e?38/b:30/b},V=function(e,t){if(console.log("!!@@@@",t,S.value),e<=1)return{color:W[e%W.length],borderColor:W[e%W.length],borderWidth:.5,opacity:1};var n=!1;return S.value&&S.value.idx==t.idx&&(n=!0),{color:W[e%W.length],borderColor:W[e%W.length],borderWidth:.5,shadowColor:n?"rgb(43, 124, 233)":"transparent",shadowBlur:20}},H=function(e,t){return{color:1==e?"rgba(0,0,0,.1)":U[t.level1Root]||"rgba(0,0,0,.4)",width:1}},Y=function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>4?arguments[4]:void 0;if(e>=5){var o=180*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/Math.PI,r=Z(0,0,(null==n?void 0:n.x)+0,(null==n?void 0:n.y)+0,100,t),a=G(5);return{show:!0,position:[r.dx+a,r.dy+a],fontSize:10,color:"#333",fontWeight:"normal",align:"center",verticalAlign:"middle",rotate:o>90&&o<270?180-o:-o}}return 0==e?{fontSize:12,color:"#333",fontWeight:"normal"}:{position:"inside",fontSize:1===e?12:11,color:1==e?"#fff":"#333",verticalAlign:"middle",align:"center",fontWeight:1===e?"bold":"normal",width:200}};function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Arial",o=(X._canvas||(X._canvas=document.createElement("canvas"))).getContext("2d");return o.font="".concat(t,"px ").concat(n),o.measureText(e).width}var Z=function(e,t,n,o){var r,a=arguments.length>5?arguments[5]:void 0;a.length,r=X(a)/2+25;var i=n-e,l=o-t,c=Math.atan2(l,i),d=c*(180/Math.PI);return{dx:Math.cos(c)*r,dy:Math.sin(c)*r,angleDeg:d}},$=function(e){var n=function e(t){if(!t||!1===t.visible)return null;var n=o({},t);return n.children&&Array.isArray(n.children)&&(n.children=n.children.map(e).filter((function(e){return!!e}))),n}(e);console.log("开始转换为 Graph 数据格式 treeData",n),z=n;var r=[],a=[],i=new Map;function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;function n(e){return e<=1?1:1==e?.75:2==e?.5:3==e?.3:4==e?.25:.08}if(!e.children||0===e.children.length)return n(t);var o=e.children.reduce((function(e,n){return e+c(n,t+1)}),0),r=n(t);return Math.max(o,r)}!function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;if(t&&t.name&&!1!==t.visible){var s,u=o<=1?o+"_"+(t.feature_path||t.name):o+"_"+(t.feature_path||t.name)+"_"+t.idx,f=function(e){return{0:0,1:125,2:215,3:310,4:400,5:500}[e]||420+40*(e-6)}(o),p=0,v=0;0===o?(p=0,v=0,s=0):(s=(l+d)/2,p=Math.cos(s)*f,v=Math.sin(s)*f);var b={id:u,idx:t.idx,name:t.name||"Unknown",originalName:t.originalName?t.originalName:null,hasAbbr:t.hasAbbr,feature_path:t.feature_path||"",level:o,metaData:t.metaData,x:p,y:v,angle:s,sectorStart:l,sectorEnd:d,fixed:!0,symbolSize:t.symbolSize||G(o),label:Y(o,s,t.name||"",f,{x:p,y:v}),itemStyle:t.itemStyle||V(o,t),category:o};if(0!=o&&r.push(b),i.set(t.name,u),n&&o>=2&&a.push({source:n,target:u,lineStyle:t.lineStyle||H(o,t)}),t.children&&t.children.length>0){var h=t.children.map((function(e){return c(e,o+1)})),g=h.reduce((function(e,t){return e+t}),0),m=d-l;0===o&&(m=2*Math.PI);var y=l;t.children.forEach((function(t,n){var r=h[n]/g*m,a=y+r;e(t,u,o+1,y,a),y=a}))}}}(n,null,0,0,2*Math.PI),console.log("Graph 节点布局完成，节点数量:",r.length,r,a),l(n)<=2?B.forEach((function(e){e.label.show=!0})):B.forEach((function(e){e.label.show=!1}));var d=[].concat(B,a);return console.log("!!!linksResult",d),{nodes:[].concat(t(q),r),links:d}},J=function(e){c&&function t(n,o){n.visible=o<=e,n.children&&n.children.length>0&&n.children.forEach((function(e){return t(e,o+1)}))}(c,0)},K=function(t){if(d&&d.nodes&&0!==d.nodes.length){console.log("初始化 Graph 图表，节点数量:",d.nodes.length);var n={tooltip:{trigger:"item",triggerOn:"mousemove",extraCssText:"max-width: 400px; white-space: normal;",formatter:function(e){if("node"===e.dataType){var t=e.data,n="<strong>Node: </strong>".concat(t.hasAbbr?t.originalName+" ("+t.name+")":t.name," <br/>");return t.feature_path&&(n+="<strong>Feature Path: </strong> ".concat(t.feature_path,"<br/>")),n}if("edge"===e.dataType&&e.data&&"rootLink"===e.data.type){var o="<strong>Flow Graph:</strong><br/>";return o+="<strong>From: </strong> ".concat(e.data.content.from,"<br/>"),o+="<strong>To: </strong> ".concat(e.data.content.to,"<br/>"),e.data.label&&e.data.label.formatter&&(o+="<strong>Data Type: </strong> ".concat(e.data.content.data_type,"<br/>")),o}return"edge"===e.dataType?"":e.name||""}},series:[{type:"graph",layout:"none",roam:"move",zoom:b,center:[0,0],data:d.nodes,links:d.links,symbol:"circle",symbolSize:30,label:{show:!0,position:function(e){return e&&e.data&&e.data.level>=5?"right":"inside"},fontSize:function(e){return e&&e.data&&e.data.level>=5?10:12},formatter:function(e){var t=e.name||"";if(e&&e.data&&e.data.level>=3)return t;for(var n=t.split(" "),o=[],r=0;r<n.length;r++){var a=n[r];o.push(a)}return o.join("\n")}},lineStyle:{color:"source",curveness:0,width:1},animationDurationUpdate:750,animationEasingUpdate:"quinticInOut"}]};t.setOption(n),t.on("mouseover",(function(e){if("series"===e.componentType&&"node"===e.dataType&&e.data.level>1){var t=e.data.idx;if(clearTimeout(ve),be===t)return;be=t,le(e.data)}})),t.on("mouseout",(function(e){if("series"===e.componentType&&"node"===e.dataType&&e.data.level>1){var t=e.data.idx;if(be!==t)return;clearTimeout(ve),ve=setTimeout((function(){be!==t||de()||(ce(),be=null)}),200)}})),setTimeout((function(){var e=a(t.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform(),6);j=e[4],A=e[5],console.log("初始偏移量:",{initialTranslateX:j,initialTranslateY:A})}),100),t.on("graphRoam",(function(){g=!0,ce(),setTimeout((function(){g=!1,console.log("拖拽/缩放结束")}),300),ne()})),t.on("mousedown",(function(){console.log("mousedown"),g=!0,ce()})),t.on("mouseup",(function(){console.log("mouseup"),setTimeout((function(){g=!1,console.log("鼠标操作结束")}),100)})),t.on("click",(function(n){"node"===n.dataType&&(console.log("params.data",n.data),n.data.level>1?S.value=n.data:S.value=null,function(t){var n=function t(n,o){if(n.idx===o)return n;if(n.children){var r,a=e(n.children);try{for(a.s();!(r=a.n()).done;){var i=t(r.value,o);if(i)return i}}catch(l){a.e(l)}finally{a.f()}}return null}(c,t),o=!1;if(n&&n.children){var r,a=e(n.children);try{for(a.s();!(r=a.n()).done;)if(!1===r.value.visible){o=!0;break}}catch(i){a.e(i)}finally{a.f()}n.children.forEach((function(e){if(e.visible=!e.visible,!e.visible&&e.children){var t=function(e){e.visible=!1,e.children&&e.children.forEach(t)};t(e)}}))}}(n.data.idx),d=$(c),t.setOption({series:[{data:d.nodes,links:d.links}]}),re(n.data))}))}else console.error("Graph 数据不存在或为空:",d)},Q=function(e){console.log(d.nodes);var t=d.nodes.find((function(t){return t.idx===e}));if(console.log("!!!",e,t),t){var n=d.nodes.findIndex((function(t){return t.idx===e}));d.nodes[n].emphasis={itemStyle:{color:"rgb(43, 124, 233)"},label:{fontWeight:"bold",color:"#000"}},h.setOption({series:[{center:[t.x,t.y],data:d.nodes}]}),h.dispatchAction({type:"highlight",seriesIndex:0,dataIndex:n}),setTimeout((function(){h.dispatchAction({type:"downplay",seriesIndex:0,dataIndex:n}),delete d.nodes[n].emphasis,h.setOption({series:[{data:d.nodes}]})}),2e3),console.log("聚焦到节点: ".concat(e))}else console.log("节点 ".concat(e," 不在当前视图中，开始逐层展开")),ee(e)},ee=function(t){var n=!1,o=function(t,n){if(!t)return!1;if(t.idx===n)return t.visible=!0,!0;if(t.children&&t.children.length>0){var r,a=e(t.children);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(o(i,n))return t.visible=!0,t.children.forEach((function(e){e.visible=!0})),!0}}catch(l){a.e(l)}finally{a.f()}}return!1};n||(n=o(c,t))&&(d=$(c),h.setOption({series:[{data:d.nodes,links:d.links}]}),Q(t))},te=function(e){console.log("22",e),Q(e)},ne=function(){var e=l(z);console.log("depth",e);var t=a(h.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform(),6),n=t[4],o=t[5],r=300*(e-1),i=Math.min((r-E)/2+E,r),c=Math.min((r-P)/2+P,r),d=n,s=o;console.log(E,P),Math.abs(n-j)>i&&(d=n>j?j+i:j-i),Math.abs(o-A)>c&&(s=o>A?A+c:A-c),console.log("&&",n,o),console.log("x移动了多少",Math.abs(n-j),"最多可拖拽",i),console.log("y移动了多少",Math.abs(o-A),"最多可拖拽",c),d===n&&s===o||(oe(),console.log("aaa",d-n,s-o))},oe=function(){h.setOption({series:[{center:[0,0],data:d.nodes}]}),setTimeout((function(){h.setOption({series:[{data:d.nodes}]})}),150)};function re(e){if(h&&e){console.log("@@@",e);var t=h.convertToPixel({seriesIndex:0},[e.x,e.y]),n=h.getDom(),o=n.offsetWidth,r=n.offsetHeight,i=h.getModel().getSeriesByIndex(0).option.zoom,l=80*i,c=a(t,2),d=c[0],s=c[1],u=!1;if((d<l||d>o-l||s<l||s>r-l)&&(u=!0),u){console.log("needMove");var f=e.x,p=e.y,v=Math.sqrt(f*f+p*p);if(0===v)return;var b=Math.max(0,v-200/i)/v,g=f*b,m=p*b;h.setOption({series:[{center:[g,m]}]})}}}var ae=function(e){x.value.some((function(t){return t.idx===e.idx}))?x.value=x.value.filter((function(t){return t.idx!==e.idx})):(x.value.unshift(e),r.value.handleNodeSearch(0))},ie=function(){if(!(m&&m.level<=1)&&m){var e=m.idx;if(x.value.some((function(t){return t.idx===e})))console.log("点击减号，移除节点:",m),x.value=x.value.filter((function(t){return t.idx!==e}));else{if(x.value.length>=w.value)return void alert("最多只能选择 ".concat(w.value," 个节点！"));console.log("点击加号，添加节点:",m),x.value.unshift(m),r.value.handleNodeSearch(0),console.log("!!!!",x)}console.log("当前选择的节点列表:",x.value),le(m)}},le=function(e){if(y&&!g)try{var t=x.value.some((function(t){return t.idx===e.idx})),n=h.convertToPixel("series",[e.x,e.y]),o=e.symbolSize||30;console.log(n);var r=h.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform(),a=1;Array.isArray(r)&&6===r.length?a=r[0]:r&&"number"==typeof r.zoom&&(a=r.zoom);var i=o/2*a*Math.sin(Math.PI/4),l=-o/2*a*Math.sin(Math.PI/4);y.style.left=n[0]+i+"px",y.style.top=n[1]+l+"px",y.style.display="flex",t?(y.getElementsByClassName("icon")[0].textContent="−",y.style.backgroundColor="#f56c6c",y.title="点击取消选择"):x.value.length>=w.value?(y.getElementsByClassName("icon")[0].textContent="+",y.style.backgroundColor="#909399",y.title="已达到最大选择数量 (".concat(x.value.length,"/").concat(w.value,")")):(y.getElementsByClassName("icon")[0].textContent="+",y.style.backgroundColor="#409eff",y.title="点击选择节点 (".concat(x.value.length,"/").concat(w.value,")")),m=e}catch(c){console.error("显示按钮失败:",c)}},ce=function(){clearTimeout(ve),y&&(y.style.display="none"),m=null,be=null},de=function(){return!!y&&y.matches(":hover")},se=function(e){x.value=x.value.filter((function(t){return t.idx!==e})),console.log("移除节点:",e),console.log("当前选择的节点列表:",x.value)},ue=function(){x.value=[]},fe=function(e){w.value=e,console.log("从组件更新最大选择节点数量为:",e)},pe=function(){y&&(y.addEventListener("mouseenter",(function(){console.log("鼠标进入加号按钮"),clearTimeout(ve)})),y.addEventListener("mouseleave",(function(){console.log("鼠标离开加号按钮"),ce()})))},ve=null,be=null;return function(e,t){var n=k("el-button");return u(),f("div",xe,[p("div",we,[p("div",ke,[C(me,{ref_key:"selectedNodesPanelRef",ref:r,style:{width:"20%","min-width":"300px","max-width":"600px"},selectedNodeList:x.value,maxSelectedNodes:w.value,currNode:S.value,onRemoveSelectedNode:se,onClearAllSelectedNodes:ue,onUpdateMaxNodes:fe,onHandleSelectedNodeClick:te,onHandleCurrNodePlusClick:ae},null,8,["selectedNodeList","maxSelectedNodes","currNode"]),p("div",Ne,[Se,p("div",{id:"plusButton",class:"plus-button",style:{display:"none"},onClick:ie},Ce),p("div",_e,[C(n,{style:{width:"120px"},color:"rgb(43, 124, 233)",type:"primary",onClick:t[0]||(t[0]=function(e){return t=D.value,D.value=!D.value,t=D.value?5:1,J(t),d=$(c),h.setOption({series:[{data:d.nodes,links:d.links}]}),void h.setOption({series:[{center:[0,0]}]});var t})},{default:_((function(){return[N(v(D.value?"Close All Nodes":"Show All Nodes"),1)]})),_:1})]),p("div",je,[C(n,{class:"center-view-btn",style:{width:"120px"},color:"rgb(43, 124, 233)",onClick:oe},{default:_((function(){return[N(" Center View")]})),_:1})])])])])])}}};n("default",w(Ae,[["__scopeId","data-v-c62e54a2"]]))}}}))}();
