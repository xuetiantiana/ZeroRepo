import{h as lt,g as Te}from"./util-D_xHXW5K.js";import{d as Ee,r as O,o as v,c as y,a as l,t as $,F,b as X,e as G,n as ve,p as pe,f as ye,_ as xe,g as oe,h as Q,i as ge,j as W,w as Y,k as at,l as me,u as De,m as it,q as rt,s as ct,v as dt,x as ut}from"./index-BffYLFjq.js";import{i as Ie}from"./index-CVOXnaBf.js";const be=r=>(pe("data-v-9b2498fe"),r=r(),ye(),r),ht={key:0,class:"body"},ft={class:"info-item",style:{"padding-right":"15px"}},gt=be(()=>l("span",{class:"info-label"},"Node:",-1)),mt={class:"info-value"},vt={class:"info-item"},pt=be(()=>l("span",{class:"info-label"},"Feature_Path:",-1)),yt={class:"info-value"},xt={key:0,class:"info-file_pat_"},bt={class:"info-label"},_t={class:"info-value"},Nt={key:0,style:{"margin-top":"0.5em"}},St=["onClick"],kt={key:1},Ct={key:2,style:{"margin-top":"0.5em"}},$t=be(()=>l("b",{style:{"margin-top":"0.5em"}},"methods: ",-1)),wt={key:0,class:"info-file_pat_"},Mt={class:"info-label"},Tt={class:"info-value"},Dt={class:"info-label"},It=["onClick"],At=Ee({__name:"nodeDetailComponent",props:{currNode:{type:Object,required:!0,default:()=>({})}},setup(r){const R=O(new Set),w=A=>{R.value.has(A)?R.value.delete(A):R.value.add(A)},u=A=>R.value.has(A);return(A,x)=>r.currNode&&r.currNode.metaData?(v(),y("div",ht,[l("div",ft,[gt,l("span",mt,$(r.currNode.metaData.node),1)]),l("div",vt,[pt,l("span",yt,$(r.currNode.metaData.feature_path),1)]),(v(!0),y(F,null,X(r.currNode.metaData.file_paths,(B,N)=>(v(),y("div",{key:N,class:"info-item"},[(v(!0),y(F,null,X(B,(f,c,M)=>(v(),y(F,{key:M},[c!=="extra"?(v(),y("div",xt,[l("span",bt,$(c)+":",1),l("span",_t,$(f),1)])):G("",!0)],64))),128)),B.extra?(v(),y("div",Nt,[(v(!0),y(F,null,X(B.extra,(f,c,M)=>(v(),y(F,{key:M},[c=="docstring"?(v(),y("div",{key:0,class:ve(["info-docstring",{expanded:u("".concat(N,"-").concat(c))}])},[l("b",null,$(c)+": ",1),l("span",{class:"docstring-content",onClick:E=>w("".concat(N,"-").concat(c))},$(f),9,St)],2)):c!=="methods"?(v(),y("p",kt,[l("b",null,$(c)+": ",1),l("span",null,$(f),1)])):c=="methods"?(v(),y("div",Ct,[$t,(v(!0),y(F,null,X(f,(E,D)=>(v(),y("div",{key:D,style:{"margin-bottom":"0.5em"}},[(v(!0),y(F,null,X(E,(S,z,g)=>(v(),y(F,{key:g},[z!=="docstring"?(v(),y("div",wt,[l("span",Mt,$(z)+":",1),l("span",Tt,$(S),1)])):z=="docstring"?(v(),y("div",{key:1,class:ve(["info-docstring",{expanded:u("".concat(N,"-").concat(D,"-").concat(z))}])},[l("span",Dt,$(z)+":",1),l("span",{class:"docstring-content",onClick:k=>w("".concat(N,"-").concat(D,"-").concat(z))},$(S),9,It)],2)):G("",!0)],64))),128))]))),128))])):G("",!0)],64))),128))])):G("",!0)]))),128))])):G("",!0)}}),Ae=xe(At,[["__scopeId","data-v-9b2498fe"]]),Be=r=>(pe("data-v-e1e38bf0"),r=r(),ye(),r),Et={class:"sidebar"},Bt=Be(()=>l("div",{class:"sidebar-header"},[l("h2",null,"ZeroRepo")],-1)),zt={class:"sidebar-content"},Ot={class:"current-node-box",ref:"nodeModalRef"},Rt={class:"select-node-item",style:{}},Ft={class:"node-header"},Wt={class:"node-title",style:{"margin-right":"12px"}},Pt=Be(()=>l("span",null,"CurrNode:  ",-1)),Lt={class:"icon"},jt={class:"node-body"},Vt={style:{display:"flex","flex-direction":"column",flex:"1",overflow:"hidden",padding:"1em 0.5em 0 1em",margin:"1em 0.5em","border-radius":"15px",background:"rgba(212, 212, 212, 0.1)"}},Gt={style:{}},Ht={style:{margin:"0 0 1em","padding-right":"7px","font-size":"18px"}},Ut={style:{"margin-right":"7px","margin-bottom":"6px"}},qt={class:"selected-nodes-box"},Xt=["onClick"],Yt=["onClick"],Zt=["onClick"],Jt=Ee({__name:"SelectedNodesPanel",props:{selectedNodeList:{type:Array,required:!0,default:[]},currNode:{type:Object,required:!0,default:()=>({})},maxSelectedNodes:{type:Number,required:!0,default:0}},emits:["removeSelectedNode","clearAllSelectedNodes","handleSelectedNodeClick","handleCurrNodePlusClick"],setup(r,{expose:R,emit:w}){const u=w,A=g=>{S.value.delete(g),u("removeSelectedNode",g)},x=()=>{S.value.clear(),u("clearAllSelectedNodes"),f.value=""},B=g=>{u("handleSelectedNodeClick",g)},N=g=>{u("handleCurrNodePlusClick",g)},f=O(""),c=O(null),M=O({});function E(g,k){g&&(M.value[k]=g)}const D=g=>{g!=null&&at(()=>{const k=M.value[g];k&&c.value&&k.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})})},S=O(new Set);function z(g){S.value.has(g)?S.value.delete(g):S.value.add(g)}return R({handleNodeSearch:D}),(g,k)=>{const H=oe("el-button"),ce=oe("el-option"),U=oe("el-select"),ne=oe("el-icon");return v(),y("div",null,[l("div",Et,[Bt,l("div",zt,[l("div",Ot,[l("div",Rt,[l("div",Ft,[l("h3",Wt,[Pt,Q(" "+$(r.currNode&&typeof r.currNode=="object"&&Object.keys(r.currNode).length>0?r.currNode.hasAbbr?r.currNode.originalName+" ("+r.currNode.name+")":r.currNode.metaData.node:"None"),1)]),r.currNode&&typeof r.currNode=="object"&&Object.keys(r.currNode).length>0?(v(),y("div",{key:0,class:"plus-button",onClick:k[0]||(k[0]=p=>N(r.currNode))},[l("span",Lt,$(r.selectedNodeList.some(p=>p.idx===r.currNode.idx)?"-":"+"),1)])):G("",!0)]),l("div",jt,[r.currNode&&r.currNode.metaData?(v(),ge(Ae,{key:0,currNode:r.currNode},null,8,["currNode"])):G("",!0)])])],512),l("div",Vt,[l("div",Gt,[l("h4",Ht,[Q(" Added Nodes ("+$(r.selectedNodeList.length)+") ",1),W(H,{class:"clear-all-btn",size:"small",style:{float:"right"},onClick:x},{default:Y(()=>[Q("Clear All")]),_:1})]),l("div",Ut,[W(U,{modelValue:f.value,"onUpdate:modelValue":k[1]||(k[1]=p=>f.value=p),filterable:"",placeholder:"Type to search yours added nodes below...",clearable:"",style:{width:"100%"},onChange:D},{default:Y(()=>[(v(!0),y(F,null,X(r.selectedNodeList,(p,Z)=>{var P;return v(),ge(ce,{key:p.id,label:((P=p.metaData)==null?void 0:P.node)||p.label,value:Z},null,8,["label","value"])}),128))]),_:1},8,["modelValue"])])]),l("div",qt,[l("div",{ref_key:"selectedNodesScrollContainer",ref:c,class:"selected-nodes-list"},[(v(!0),y(F,null,X(r.selectedNodeList,(p,Z)=>(v(),y("div",{key:p.idx||Z,ref_for:!0,ref:P=>E(P,Z),class:"select-node-item"},[l("div",{class:"node-header",style:me({"border-left":"4px solid ".concat(p.selectedColor)})},[l("h3",{onClick:P=>B(p.idx),class:"node-title",style:me({color:p.selectedColor})},$(p.hasAbbr?p.originalName+" ("+p.name+")":p.metaData.node),13,Xt),l("button",{class:"close-btn",onClick:P=>A(p.idx)},[W(ne,null,{default:Y(()=>[W(De(it))]),_:1})],8,Yt)],4),l("div",{class:ve(["node-body",{expanded:S.value.has(p.idx)}])},[l("button",{class:"dropdown-btn",onClick:P=>z(p.idx),style:{position:"absolute",right:"2px",top:"0px","z-index":"2"}},[W(ne,{style:me({transform:S.value.has(p.idx)?"rotate(180deg)":"rotate(0deg)"})},{default:Y(()=>[W(De(rt))]),_:2},1032,["style"])],8,Zt),p&&p.metaData?(v(),ge(Ae,{key:0,currNode:p},null,8,["currNode"])):G("",!0)],2)]))),128))],512)])])])])])}}}),Kt=xe(Jt,[["__scopeId","data-v-e1e38bf0"]]),_e=r=>(pe("data-v-30bfbd41"),r=r(),ye(),r),Qt={class:""},eo={style:{height:"100vh"}},to={id:"viewport",style:{display:"flex"}},oo={id:"wrapper",style:{flex:"1",overflow:"hidden",height:"100%"}},no=_e(()=>l("div",{id:"echart",style:{width:"100%",height:"100%"}},null,-1)),so=_e(()=>l("span",{class:"icon"},"+",-1)),lo=[so],ao={class:"showAllNodes",style:{position:"absolute",right:"20px",top:"15px","z-index":"1000"}},io={style:{position:"absolute",right:"150px",top:"15px","z-index":"1000"}},ro={style:{position:"absolute",right:"280px",top:"15px","z-index":"1000"}},co=_e(()=>l("div",{style:{width:"2000px",height:"2000px",position:"fixed",top:"0",left:"0","z-index":"-1",opacity:"0"}},[l("div",{id:"print-echart",style:{width:"100%",height:"100%"}})],-1)),uo={__name:"echart3",setup(r){const R=O();let w=null,u={nodes:[],links:[]},A=1,x=null,B=!1,N=null,f=null;const c=O([]),M=O(1e6),E=O();let D=0,S=0,z=[];ct(M,(t,n)=>{if(console.log("最大选择数量从 ".concat(n," 变更为 ").concat(t)),c.value.length>t){const e=c.value.slice(t);c.value=c.value.slice(0,t),console.log("由于限制变更，移除了以下节点:",e),alert("由于限制变更，已移除 ".concat(e.length," 个节点"))}});let g=1e3,k=1e3;dt(()=>{g=document.getElementById("echart").getBoundingClientRect().width,k=document.getElementById("echart").getBoundingClientRect().height;const t=Math.min(g,k);A=Math.max(2500/t,1),f=document.getElementById("plusButton"),Ke(),console.log("屏幕尺寸：",g,k,2500/t,A);const n=document.getElementById("echart");n&&(x=Ie(n),Promise.all([fetch("./data/webui.json").then(e=>e.json()),fetch("./data/map.json").then(e=>e.json())]).then(([e,o])=>{console.log("webui:",e),console.log("map:",o),ne(e.data_flow_graph),w=lt(e,o),Se(1),u=ee(w),Le(x),Qe()}).catch(e=>{console.error("请求失败:",e)}),ut(()=>{x.dispose()}))});const H=O(!1),ce=t=>{H.value=!H.value,t=H.value?5:1,Se(t),u=ee(w),x.setOption({series:[{data:u.nodes,links:u.links}]}),x.setOption({series:[{center:[0,0]}]})},U=[],ne=t=>{t.forEach(n=>{const e=n.from,o=n.to;if(e&&o){const s={source:"1_"+e,target:"1_"+o,type:"rootLink",content:n,label:{show:!0,formatter:n.data_type||n.label||"",color:"#000",fontSize:9,position:"middle"},lineStyle:{color:"#000",width:1,type:"dashed",opacity:1},symbol:["circle","arrow"],symbolSize:[4,8]};U.push(s)}}),console.log(U)};function p(t){const n=[{name:"test1",x:t,y:t},{name:"test2",x:-t,y:-t},{name:"test3",x:-t,y:t},{name:"test4",x:t,y:-t}];return console.log("Dddd"),n.map(e=>({...e,id:e.name,itemStyle:{opacity:0},label:{show:!1}}))}const Z=p(680),P=t=>({0:0,1:125,2:215,3:310,4:400,5:500})[t]||420+(t-6)*40,L=["#686759","#0068B8","#62BDE4","#52E0FC","#86DCF8","#BAD7F3"],ze={"Advanced Modeling Techniques":"#FF8364",Algorithms:"#5414E9",Workflow:"#00C6A2","Data Engineering":"#0368FF"},Ne=(t,n)=>{let e,o=t?1.5:A;return n==0?e=1:n==1?e=100/o:n==2?e=80/o:n==3?e=70/o:n==4?e=38/o:e=t?10:25/o,e},Oe=(t,n,e)=>{if(console.log("!!@@@@",e,E.value),n<=1)return{color:L[n%L.length],borderColor:L[n%L.length],borderWidth:.5,opacity:1};{let o=!1;return E.value&&E.value.idx==e.idx&&(o=!0),o=t?!1:o,{color:o?"rgb(0, 120, 212)":L[n%L.length],borderColor:L[n%L.length],borderWidth:1}}},Re=(t,n)=>({color:t==1?"rgba(0,0,0,.1)":ze[n.level1Root]||"rgba(0,0,0,.4)",width:1}),Fe=(t,n,e,o=0,s="",d=0,i)=>{let h=!1;if(E.value&&E.value.idx==n.idx&&(h=!0),h=t?!1:h,e>=5){let _=o*180/Math.PI;const a=We(0,0,(i==null?void 0:i.x)+0,(i==null?void 0:i.y)+0,100,s),b=Ne(t,5);return{show:!0,position:[a.dx+b,a.dy+b],fontSize:10,color:h?"#000":"#333",fontWeight:h?"bold":"normal",align:"center",verticalAlign:"middle",rotate:_>90&&_<270?180-_:-_}}let C={};return e==0?C={fontSize:12,color:"#333",fontWeight:"normal"}:C={position:"inside",fontSize:e===1?12:11,color:e==1||h?"#fff":"#333",textBorderColor:"#000",textBorderWidth:h?2:0,textShadowColor:"rgba(0,0,0,0.5)",textShadowBlur:h?4:0,verticalAlign:"middle",align:"center",fontWeight:e===1?"bold":"normal",width:200},C};function de(t,n=10,e="Arial"){const s=(de._canvas||(de._canvas=document.createElement("canvas"))).getContext("2d");return s.font="".concat(n,"px ").concat(e),s.measureText(t).width}const We=(t,n,e,o,s=30,d)=>{d.length*3,s=de(d)/2+25;const h=e-t,C=o-n,_=Math.atan2(C,h),a=_*(180/Math.PI),b=Math.cos(_)*s,m=Math.sin(_)*s;return{dx:b,dy:m,angleDeg:a}},ee=(t,n=!1)=>{function e(a){if(!a||a.visible===!1)return null;const b={...a};return b.children&&Array.isArray(b.children)&&(b.children=b.children.map(e).filter(m=>!!m)),b}const o=e(t);console.log("开始转换为 Graph 数据格式 treeData",o),z=o;const s=[],d=[],i=new Map;function h(a,b=0){function m(I){let T=1;return I<=1?T=1:I==1?T=.75:I==2?T=.5:I==3?T=.3:I==4?T=.25:T=.08,T}if(!a.children||a.children.length===0)return m(b);const q=a.children.reduce((I,T)=>I+h(T,b+1),0),V=m(b);return Math.max(q,V)}function C(a,b=null,m=0,q=0,V=2*Math.PI){if(!a||!a.name||a.visible===!1)return;const I=m<=1?m+"_"+(a.feature_path||a.name):m+"_"+(a.feature_path||a.name)+"_"+a.idx,T=P(m);let K,ie=0,re=0;m===0?(ie=0,re=0,K=0):(K=(q+V)/2,ie=Math.cos(K)*T,re=Math.sin(K)*T);const tt={id:I,idx:a.idx,name:a.name||"Unknown",originalName:a.originalName?a.originalName:null,hasAbbr:a.hasAbbr,feature_path:a.feature_path||"",level:m,metaData:a.metaData,x:ie,y:re,angle:K,sectorStart:q,sectorEnd:V,fixed:!0,symbolSize:a.symbolSize||Ne(n,m),label:Fe(n,a,m,K,a.name||"",T,{x:ie,y:re}),itemStyle:a.itemStyle||Oe(n,m,a),category:m};if(m!=0&&s.push(tt),i.set(a.name,I),b&&m>=2&&d.push({source:b,target:I,lineStyle:a.lineStyle||Re(m,a)}),a.children&&a.children.length>0){const $e=a.children.map(te=>h(te,m+1)),ot=$e.reduce((te,fe)=>te+fe,0);let we=V-q;m===0&&(we=2*Math.PI);let he=q;a.children.forEach((te,fe)=>{const nt=$e[fe]/ot*we,st=he,Me=he+nt;C(te,I,m+1,st,Me),he=Me})}}C(o,null,0,0,2*Math.PI),console.log("Graph 节点布局完成，节点数量:",s.length,s,d),Te(o)<=2?U.forEach(a=>{a.label.show=!0}):U.forEach(a=>{a.label.show=!1});let _=[...U,...d];return console.log("!!!linksResult",_),{nodes:[...Z,...s],links:_}},Se=t=>{function n(e,o){e.visible=o<=t,e.children&&e.children.length>0&&e.children.forEach(s=>n(s,o+1))}w&&n(w,0)},Pe=t=>{function n(s,d){if(s.idx===d)return s;if(s.children)for(const i of s.children){const h=n(i,d);if(h)return h}return null}const e=n(w,t);let o=!1;if(e&&e.children){for(const s of e.children)if(s.visible===!1){o=!0;break}e.children.forEach(s=>{if(s.visible=!s.visible,!s.visible&&s.children){const d=i=>{i.visible=!1,i.children&&i.children.forEach(d)};d(s)}})}return o},Le=t=>{if(!u||!u.nodes||u.nodes.length===0){console.error("Graph 数据不存在或为空:",u);return}console.log("初始化 Graph 图表，节点数量:",u.nodes.length);var n={tooltip:{trigger:"item",triggerOn:"mousemove",extraCssText:"max-width: 400px; white-space: normal;",formatter:function(e){if(e.dataType==="node"){const o=e.data;let s="<strong>Node: </strong>".concat(o.hasAbbr?o.originalName+" ("+o.name+")":o.name," <br/>");return o.feature_path&&(s+="<strong>Feature Path: </strong> ".concat(o.feature_path,"<br/>")),s}if(e.dataType==="edge"&&e.data&&e.data.type==="rootLink"){let o="<strong>Flow Graph:</strong><br/>";return o+="<strong>From: </strong> ".concat(e.data.content.from,"<br/>"),o+="<strong>To: </strong> ".concat(e.data.content.to,"<br/>"),e.data.label&&e.data.label.formatter&&(o+="<strong>Data Type: </strong> ".concat(e.data.content.data_type,"<br/>")),o}return e.dataType==="edge"?"":e.name||""}},series:[{type:"graph",layout:"none",roam:"move",zoom:A,center:[0,0],data:u.nodes,links:u.links,symbol:"circle",symbolSize:30,label:{show:!0,position:function(e){return e&&e.data&&e.data.level>=5?"right":"inside"},fontSize:function(e){return e&&e.data&&e.data.level>=5?10:12},formatter:function(e){var o=e.name||"";if(e&&e.data&&e.data.level>=3)return o;for(var s=o.split(" "),d=[],i=0;i<s.length;i++){var h=s[i];d.push(h)}return d.join("\n")}},lineStyle:{color:"source",curveness:0,width:1},animationDurationUpdate:750,animationEasingUpdate:"quinticInOut"}]};t.setOption(n),t.on("mouseover",function(e){if(e.componentType==="series"&&e.dataType==="node"&&e.data.level>1){const o=e.data.idx;if(clearTimeout(J),j===o)return;j=o,ue(e.data)}}),t.on("mousemove",function(e){if(console.log("mousemove"),e.componentType==="series"&&e.dataType==="node"&&e.data.level>1){const o=e.data.idx;if(clearTimeout(J),j===o)return;j=o,ue(e.data)}}),t.on("mouseout",function(e){if(e.componentType==="series"&&e.dataType==="node"&&e.data.level>1){const o=e.data.idx;if(j!==o)return;clearTimeout(J),J=setTimeout(()=>{j===o&&!Xe()&&(se(),j=null)},200)}}),setTimeout(()=>{[,,,,D,S]=t.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform(),console.log("初始偏移量:",{initialTranslateX:D,initialTranslateY:S})},100),t.on("graphRoam",function(){B=!0,se(),setTimeout(()=>{B=!1,console.log("拖拽/缩放结束")},300),Ge()}),t.on("mousedown",function(){console.log("mousedown"),B=!0,se()}),t.on("mouseup",function(){console.log("mouseup"),setTimeout(()=>{B=!1,console.log("鼠标操作结束")},100)}),t.on("click",function(e){if(e.dataType==="node"){console.log("params.data",e.data),e.data.level>1?E.value=e.data:E.value=null;const o=e.data.idx;Pe(o),u=ee(w),t.setOption({series:[{data:u.nodes,links:u.links}]}),He(e.data)}})},ke=t=>{console.log(u.nodes);const n=u.nodes.find(e=>e.idx===t);if(console.log("!!!",t,n),n){const e=u.nodes.findIndex(o=>o.idx===t);u.nodes[e].emphasis={itemStyle:{color:"rgb(43, 124, 233)"},label:{fontWeight:"bold",color:"#000"}},x.setOption({series:[{center:[n.x,n.y],data:u.nodes}]}),x.dispatchAction({type:"highlight",seriesIndex:0,dataIndex:e}),setTimeout(()=>{x.dispatchAction({type:"downplay",seriesIndex:0,dataIndex:e}),delete u.nodes[e].emphasis,x.setOption({series:[{data:u.nodes}]})},2e3),console.log("聚焦到节点: ".concat(t))}else console.log("节点 ".concat(t," 不在当前视图中，开始逐层展开")),je(t)},je=t=>{let n=!1;const e=(s,d)=>{if(!s)return!1;if(s.idx===d)return s.visible=!0,!0;if(s.children&&s.children.length>0){for(const i of s.children)if(e(i,d))return s.visible=!0,s.children.forEach(h=>{h.visible=!0}),!0}return!1};(()=>{n||(n=e(w,t),n&&(u=ee(w),x.setOption({series:[{data:u.nodes,links:u.links}]}),ke(t)))})()},Ve=t=>{console.log("22",t),ke(t)},Ge=()=>{let t=Te(z);console.log("depth",t);const e=x.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform(),[,,,,o,s]=e,d=1500/5*(t-1),i=Math.min((d-g)/2+g,d),h=Math.min((d-k)/2+k,d);let C=o,_=s;console.log(g,k),Math.abs(o-D)>i&&(C=o>D?D+i:D-i),Math.abs(s-S)>h&&(_=s>S?S+h:S-h),console.log("&&",o,s),console.log("x移动了多少",Math.abs(o-D),"最多可拖拽",i),console.log("y移动了多少",Math.abs(s-S),"最多可拖拽",h),(C!==o||_!==s)&&(Ce(),console.log("aaa",C-o,_-s))},Ce=()=>{x.setOption({series:[{center:[0,0],data:u.nodes}]}),setTimeout(()=>{x.setOption({series:[{data:u.nodes}]})},150)};function He(t){if(!x||!t)return;console.log("@@@",t);const n=x.convertToPixel({seriesIndex:0},[t.x,t.y]),e=x.getDom(),o=e.offsetWidth,s=e.offsetHeight,d=x.getModel().getSeriesByIndex(0).option.zoom,i=80*d,[h,C]=n;let _=!1;if((h<i||h>o-i||C<i||C>s-i)&&(_=!0),_){console.log("needMove");const{x:a,y:b}=t,m=Math.sqrt(a*a+b*b);if(m===0)return;const V=Math.max(0,m-200/d)/m,I=a*V,T=b*V;x.setOption({series:[{center:[I,T]}]})}}const Ue=t=>{c.value.some(e=>e.idx===t.idx)?c.value=c.value.filter(e=>e.idx!==t.idx):(c.value.unshift(t),R.value.handleNodeSearch(0))},qe=()=>{if(!(N&&N.level<=1)&&N){const t=N.idx;if(c.value.some(e=>e.idx===t))console.log("点击减号，移除节点:",N),c.value=c.value.filter(e=>e.idx!==t);else{if(c.value.length>=M.value){alert("最多只能选择 ".concat(M.value," 个节点！"));return}console.log("点击加号，添加节点:",N),c.value.unshift(N),R.value.handleNodeSearch(0),console.log("!!!!",c)}console.log("当前选择的节点列表:",c.value),ue(N)}},ue=t=>{if(!(!f||B))try{const n=c.value.some(_=>_.idx===t.idx),e=x.convertToPixel("series",[t.x,t.y]),o=t.symbolSize||30;console.log(e);const d=x.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform();let i=1;Array.isArray(d)&&d.length===6?i=d[0]:d&&typeof d.zoom=="number"&&(i=d.zoom);const h=o/2*i*Math.sin(Math.PI/4),C=-o/2*i*Math.sin(Math.PI/4);f.style.left=e[0]+h+"px",f.style.top=e[1]+C+"px",f.style.display="flex",n?(f.getElementsByClassName("icon")[0].textContent="−",f.style.backgroundColor="#f56c6c",f.title="点击取消选择"):c.value.length>=M.value?(f.getElementsByClassName("icon")[0].textContent="+",f.style.backgroundColor="#909399",f.title="已达到最大选择数量 (".concat(c.value.length,"/").concat(M.value,")")):(f.getElementsByClassName("icon")[0].textContent="+",f.style.backgroundColor="#409eff",f.title="点击选择节点 (".concat(c.value.length,"/").concat(M.value,")")),N=t}catch(n){console.error("显示按钮失败:",n)}},se=()=>{clearTimeout(J),f&&(f.style.display="none"),N=null,j=null},Xe=()=>f?f.matches(":hover"):!1,Ye=t=>{c.value=c.value.filter(n=>n.idx!==t),console.log("移除节点:",t),console.log("当前选择的节点列表:",c.value)},Ze=()=>{c.value=[]},Je=t=>{M.value=t,console.log("从组件更新最大选择节点数量为:",t)},Ke=()=>{f&&(f.addEventListener("mouseenter",()=>{console.log("鼠标进入加号按钮"),clearTimeout(J)}),f.addEventListener("mouseleave",()=>{console.log("鼠标离开加号按钮"),se()}))};let J=null,j=null,le=null;const Qe=()=>{const t=document.getElementById("print-echart");le=Ie(t);var n={series:[{type:"graph",layout:"none",roam:!0,zoom:1.2,center:[0,0],data:[],links:[],symbol:"circle",symbolSize:30,label:{show:!0,position:function(e){return e&&e.data&&e.data.level>=5?"right":"inside"},fontSize:function(e){return e&&e.data&&e.data.level>=5?10:12},formatter:function(e){var o=e.name||"";if(e&&e.data&&e.data.level>=3)return o;for(var s=o.split(" "),d=[],i=0;i<s.length;i++){var h=s[i];d.push(h)}return d.join("\n")}},lineStyle:{color:"source",curveness:0,width:1},animationDurationUpdate:750,animationEasingUpdate:"quinticInOut"}]};le.setOption(n)},ae=O(!1);function et(){ae.value=!0;const t=ee(w,!0);le.setOption({series:[{data:t.nodes,links:t.links}]}),setTimeout(()=>{const n=le.getDataURL({type:"png",pixelRatio:2,backgroundColor:"#fff"}),e=document.createElement("a");e.download="ZeroRepo_UI.png",e.href=n,e.click(),setTimeout(()=>{ae.value=!1},1e3)},1e3)}return(t,n)=>{const e=oe("el-button");return v(),y("div",Qt,[l("div",eo,[l("div",to,[W(Kt,{ref_key:"selectedNodesPanelRef",ref:R,style:{width:"20%","min-width":"300px","max-width":"600px"},selectedNodeList:c.value,maxSelectedNodes:M.value,currNode:E.value,onRemoveSelectedNode:Ye,onClearAllSelectedNodes:Ze,onUpdateMaxNodes:Je,onHandleSelectedNodeClick:Ve,onHandleCurrNodePlusClick:Ue},null,8,["selectedNodeList","maxSelectedNodes","currNode"]),l("div",oo,[no,l("div",{id:"plusButton",class:"plus-button",style:{display:"none"},onClick:qe},lo),l("div",ao,[W(e,{style:{width:"120px"},color:"rgb(43, 124, 233)",type:"primary",onClick:n[0]||(n[0]=o=>ce(H.value))},{default:Y(()=>[Q($(H.value?"Close All Nodes":"Show All Nodes"),1)]),_:1})]),l("div",io,[W(e,{class:"center-view-btn",style:{width:"120px"},color:"rgb(43, 124, 233)",onClick:Ce},{default:Y(()=>[Q(" Center View")]),_:1})]),l("div",ro,[W(e,{class:"center-view-btn",style:{width:"120px"},color:"rgb(43, 124, 233)",onClick:et,disabled:ae.value,loading:ae.value},{default:Y(()=>[Q(" Print View")]),_:1},8,["disabled","loading"])])]),co])])])}}},mo=xe(uo,[["__scopeId","data-v-30bfbd41"]]);export{mo as default};
