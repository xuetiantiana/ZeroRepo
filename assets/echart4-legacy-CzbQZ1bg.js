!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return l=t.done,t},e:function(t){c=!0,i=t},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw i}}}}function r(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(e,n,r){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}System.register(["./util-legacy-Qg2MG4x8.js","./index-legacy-Ds2O1RuX.js","./index-legacy-DgfHjSEG.js"],(function(t,o){"use strict";var a,i,c,u,f,s,d,h,v,y,p;return{setters:[function(t){a=t.h,i=t.g},function(t){c=t.i},function(t){u=t._,f=t.q,s=t.s,d=t.o,h=t.c,v=t.p,y=t.f,p=t.a}],execute:function(){var o=document.createElement("style");o.textContent=".header h3[data-v-74afaa93]{margin:10px 0;text-align:center}#viewport[data-v-74afaa93]{width:100vw;height:calc(100vh - 120px);overflow:hidden;position:relative}#wrapper[data-v-74afaa93],#echart[data-v-74afaa93]{width:100%;height:100%}\n",document.head.appendChild(o);var g={class:""},m=[function(t){return v("data-v-74afaa93"),t=t(),y(),t}((function(){return p("div",{class:"header"},[p("h3",null,"ECharts Graph 图表 (无交叉扇形布局)"),p("div",{id:"viewport"},[p("div",{id:"wrapper"},[p("div",{id:"echart",style:{width:"100%",height:"100%"}})])])],-1)}))],b={__name:"echart4",setup:function(t){var o=null,u={nodes:[],links:[]},v=1,y=null;f((function(){var t=window.innerWidth,e=window.innerHeight,n=Math.min(t,e);v=Math.max(1800/n,1),console.log("屏幕尺寸：",t,e,1800/n,v);var r=document.getElementById("echart");r&&(y=c(r),fetch("./data/webui.json").then((function(t){return t.json()})).then((function(t){b(t.data_flow_graph);var e=a(t);o=e,k(1),u=A(o),z(y)})),s((function(){y.dispose()})))}));var p=[],b=function(t){t.forEach((function(t){var e=t.from,n=t.to;if(e&&n){var r={source:"1_"+e,target:"1_"+n,type:"rootLink",content:t,label:{show:!0,formatter:t.data_type||t.label||"",color:"#000",fontSize:9,position:"middle"},lineStyle:{color:"#000",width:1,type:"dashed",opacity:1},symbol:["circle","arrow"],symbolSize:[4,8]};p.push(r)}})),console.log(p)};var w,S,x=(S=[{name:"test1",x:w=500,y:w},{name:"test2",x:-w,y:-w},{name:"test3",x:-w,y:w},{name:"test4",x:w,y:-w}],console.log("Dddd"),S.map((function(t){return l(l({},t),{},{id:t.name,itemStyle:{opacity:0},label:{show:!1}})}))),O=["#686759","#B04B35","#E37C05","#5F9DBF","#568651","#B89C80"],j=["#686759","#cfb9b4","#ebc59a","#a4cadf","#cdefca","#B89C80"],E=function(t){return 0==t?5:1==t?82/v:t<=4?42/v:5/v},M=function(t){return{color:j[t%j.length],borderColor:j[t%j.length],borderWidth:.5}},_=function(t){return{color:1==t?"rgba(0,0,0,.1)":O[t%O.length],width:1}},P=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>4?arguments[4]:void 0;if(t>=5){var o=180*e/Math.PI;console.log("!!!!","angle",e,"deg",o,"x和y坐标",r);var a=I(0,0,null==r?void 0:r.x,null==r?void 0:r.y,100,n);return{show:!0,position:[a.dx,a.dy],fontSize:12,color:"#333",fontWeight:"normal",align:"center",verticalAlign:"middle",rotate:o>90&&o<270?180-o:-o,formatter:function(t){var e=t.name||"";if(t&&t.data&&t.data.level>=5)return o>90&&o<270?"{main|".concat(e,"    } {sub|}"):"{sub|} {main|    ".concat(e,"}");for(var n=e.split(" "),r=[],a=0;a<n.length;a++){var i=n[a];if(-1!==i.indexOf("-"))for(var l=i.split("-"),c=0;c<l.length;c++)r.push(l[c]),c<l.length-1&&r.push("-");else r.push(i)}return r.join("\n")},rich:{main:{fontSize:10,color:"#000"},sub:{fontSize:10,color:"rgba(0, 0, 0, .1)",height:-1}}}}return 0==t?{fontSize:12,color:"#333",fontWeight:"normal"}:{position:"inside",fontSize:11,color:"#333",verticalAlign:"middle",align:"center",fontWeight:1===t?"bold":"normal",width:200}},I=function(t,e,n,r){var o,a=arguments.length>5?arguments[5]:void 0;o=2.5*a.length,console.log("labelText",a.length,o);var i=n-t,l=r-e,c=Math.atan2(l,i),u=c*(180/Math.PI);return{dx:Math.cos(c)*o,dy:Math.sin(c)*o,angleDeg:u}},A=function(t){var e=function t(e){if(!e||!1===e.visible)return null;var n=l({},e);return n.children&&Array.isArray(n.children)&&(n.children=n.children.map(t).filter((function(t){return!!t}))),n}(t);console.log("开始转换为 Graph 数据格式 treeData",e);var n=[],o=[],a=new Map;function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;function n(t){return t<=1?1:1==t?.75:2==t?.5:3==t?.3:4==t?.25:.08}if(!t.children||0===t.children.length)return n(e);var r=t.children.reduce((function(t,n){return t+c(n,e+1)}),0),o=n(e);return Math.max(r,o)}!function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;if(e&&e.name&&!1!==e.visible){var f,s=i+"_"+(e.feature_path||e.name),d=function(t){return{0:0,1:140,2:240,3:340,4:440,5:500}[t]||420+40*(t-6)}(i),h=0,v=0;0===i?(h=0,v=0,f=0):(f=(l+u)/2,h=Math.cos(f)*d,v=Math.sin(f)*d);var y={id:s,name:e.name||"Unknown",feature_path:e.feature_path||"",level:i,x:h,y:v,angle:f,sectorStart:l,sectorEnd:u,fixed:!0,symbolSize:e.symbolSize||E(i),label:P(i,f,e.name||"",d,{x:h,y:v}),itemStyle:e.itemStyle||M(i),category:i};if(0!=i&&n.push(y),a.set(e.name,s),r&&i>=2&&o.push({source:r,target:s,lineStyle:e.lineStyle||_(i)}),e.children&&e.children.length>0){var p=e.children.map((function(t){return c(t,i+1)})),g=p.reduce((function(t,e){return t+e}),0),m=u-l;0===i&&(m=2*Math.PI);var b=l;e.children.forEach((function(e,n){var r=p[n]/g*m,o=b+r;t(e,s,i+1,b,o),b=o}))}}}(e,null,0,0,2*Math.PI),console.log("Graph 节点布局完成，节点数量:",n.length,n,o),i(e)<=2?p.forEach((function(t){t.label.show=!0})):p.forEach((function(t){t.label.show=!1}));var u=[].concat(p,o);return console.log("!!!linksResult",u),{nodes:[].concat(r(x),n),links:u}},k=function(t){o&&function e(n,r){n.visible=r<=t,n.children&&n.children.length>0&&n.children.forEach((function(t){return e(t,r+1)}))}(o,0)},z=function(t){if(u&&u.nodes&&0!==u.nodes.length){console.log("初始化 Graph 图表，节点数量:",u.nodes.length);var e={tooltip:{trigger:"item",triggerOn:"mousemove",extraCssText:"max-width: 400px; white-space: normal;",formatter:function(t){if("node"===t.dataType){var e=t.data,n="<strong>Node: </strong> ".concat(e.name,"<br/>");return e.feature_path&&(n+="<strong>Feature Path: </strong> ".concat(e.feature_path,"<br/>")),n}if("edge"===t.dataType&&t.data&&"rootLink"===t.data.type){var r="<strong>Flow Graph:</strong><br/>";return r+="<strong>From: </strong> ".concat(t.data.content.from,"<br/>"),r+="<strong>To: </strong> ".concat(t.data.content.to,"<br/>"),t.data.label&&t.data.label.formatter&&(r+="<strong>Data Type: </strong> ".concat(t.data.content.data_type,"<br/>")),r}return"edge"===t.dataType?"":t.name||""}},series:[{type:"graph",layout:"none",roam:!0,zoom:v,center:[0,0],scaleLimit:{min:.7*v,max:5*v},data:u.nodes,links:u.links,symbol:"circle",symbolSize:30,label:{show:!0,position:function(t){return t&&t.data&&t.data.level>=5?"right":"inside"},fontSize:function(t){return t&&t.data&&t.data.level>=5?10:12},formatter:function(t){var e=t.name||"";if(t&&t.data&&t.data.level>=5)return e+" - 111111"+e;for(var n=e.split(" "),r=[],o=0;o<n.length;o++){var a=n[o];if(-1!==a.indexOf("-"))for(var i=a.split("-"),l=0;l<i.length;l++)r.push(i[l]),l<i.length-1&&r.push("-");else r.push(a)}return r.join("\n")}},lineStyle:{color:"source",curveness:0,width:1},animationDurationUpdate:750,animationEasingUpdate:"quinticInOut"}]};t.setOption(e),t.on("click",(function(e){"node"===e.dataType&&(!function(t){var e=function t(e,r){if(e.feature_path===r)return e;if(e.children){var o,a=n(e.children);try{for(a.s();!(o=a.n()).done;){var i=t(o.value,r);if(i)return i}}catch(l){a.e(l)}finally{a.f()}}return null}(o,t),r=!1;if(e&&e.children){var a,i=n(e.children);try{for(i.s();!(a=i.n()).done;)if(!1===a.value.visible){r=!0;break}}catch(l){i.e(l)}finally{i.f()}e.children.forEach((function(t){if(t.visible=!t.visible,!t.visible&&t.children){var e=function(t){t.visible=!1,t.children&&t.children.forEach(e)};e(t)}}))}}(e.data.feature_path),u=A(o),t.setOption({series:[{data:u.nodes,links:u.links}]}),T(e.data))}))}else console.error("Graph 数据不存在或为空:",u)};function T(t){if(y&&t){console.log("@@@",t);var n=y.convertToPixel({seriesIndex:0},[t.x,t.y]),r=y.getDom(),o=r.offsetWidth,a=r.offsetHeight,i=y.getModel().getSeriesByIndex(0).option.zoom,l=80*i,c=e(n,2),u=c[0],f=c[1],s=!1;if((u<l||u>o-l||f<l||f>a-l)&&(s=!0),s){console.log("needMove");var d=t.x,h=t.y,v=Math.sqrt(d*d+h*h);if(0===v)return;var p=Math.max(0,v-200/i)/v,g=d*p,m=h*p;y.setOption({series:[{center:[g,m]}]})}}}return function(t,e){return d(),h("div",g,m)}}};t("default",u(b,[["__scopeId","data-v-74afaa93"]]))}}}))}();
