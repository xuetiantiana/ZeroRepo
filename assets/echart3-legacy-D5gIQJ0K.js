!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function n(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(t,n,o){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,n||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,d=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){d=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw r}}return l}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}System.register(["./util-legacy-BWGiHFa5.js","./index-legacy-CyE54b5n.js","./index-legacy-Ds2O1RuX.js"],(function(e,o){"use strict";var a,l,c,d,s,u,f,p,v,m,h,g,b,y,x,w,k,N,S,_,C,T,j,O,z,A;return{setters:[function(e){a=e.h,l=e.g},function(e){c=e.d,d=e.r,s=e.o,u=e.c,f=e.a,p=e.t,v=e.F,m=e.b,h=e.e,g=e.n,b=e.p,y=e.f,x=e._,w=e.g,k=e.h,N=e.i,S=e.j,_=e.w,C=e.k,T=e.l,j=e.m,O=e.q,z=e.s},function(e){A=e.i}],execute:function(){var o=document.createElement("style");o.textContent='@charset "UTF-8";.body .show[data-v-ae8090cc]{z-index:1000;opacity:1;pointer-events:auto}.body .info-item[data-v-ae8090cc]{margin-bottom:8px;overflow-wrap:break-word;word-wrap:break-word}.body .info-item .info-label[data-v-ae8090cc]{font-weight:700;color:#555}.body .info-item .info-value[data-v-ae8090cc]{margin-left:10px;color:#333}.body .info-docstring .docstring-content[data-v-ae8090cc]{cursor:pointer;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;transition:all .3s ease}.body .info-docstring.expanded .docstring-content[data-v-ae8090cc]{display:block;-webkit-line-clamp:unset;overflow:visible}.body .info-docstring.expanded .docstring-content[data-v-ae8090cc]:hover{color:#000}.sidebar[data-v-ee29cc75]{font-size:14px;height:100%;width:100%;background:#f8f9fa;border-right:2px solid #dee2e6;overflow:hidden;padding:0;box-sizing:border-box;display:flex;flex-direction:column}.sidebar .sidebar-header[data-v-ee29cc75]{display:flex;flex-direction:row;justify-content:space-between;padding:.8em 1em;border-bottom:4px solid #dee2e6}.sidebar .sidebar-content[data-v-ee29cc75]{flex:1;overflow:hidden;display:flex;flex-direction:column}.sidebar .sidebar-content .current-node-box[data-v-ee29cc75]{min-height:200px;padding:1em}.sidebar .sidebar-content .selected-nodes-box[data-v-ee29cc75]{padding:1em 0;flex:1;overflow:hidden}.sidebar .sidebar-content .selected-nodes-box>div[data-v-ee29cc75]{padding:0 1em;height:100%;overflow-y:auto}.select-node-item[data-v-ee29cc75]{width:100%;background:#fff;border:2px solid #ccc;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,.3);transition:opacity .3s ease-in-out;margin-top:1em}.select-node-item[data-v-ee29cc75]:nth-child(1){margin-top:0}.select-node-item .show[data-v-ee29cc75]{z-index:1000;opacity:1;pointer-events:auto}.select-node-item .node-header[data-v-ee29cc75]{background:#f5f5f5;padding:15px;border-bottom:1px solid #ddd;border-radius:6px 6px 0 0;position:relative}.select-node-item .node-title[data-v-ee29cc75]{margin:0;font-weight:700;color:#333;font-size:1.1em;padding-right:1em}.select-node-item .close-btn[data-v-ee29cc75]{position:absolute;right:5px;top:10px;background:none;border:none;font-size:20px;cursor:pointer;color:#666;width:30px;height:30px;border-radius:15px}.select-node-item .close-btn[data-v-ee29cc75]:hover{background:#e0e0e0;color:#000}.select-node-item .node-body[data-v-ee29cc75]{padding:15px;max-height:200px;min-height:100px;overflow-y:auto}[data-v-ee29cc75] .el-radio-group{border-radius:20px;padding:3px 4px;background:#ccc;gap:5px;--el-font-size-base: 18px}[data-v-ee29cc75] .el-radio-group .el-radio-button__inner{border:0!important;border-radius:20px!important;color:#fff;background:transparent}[data-v-ee29cc75] .el-radio-group .is-active .el-radio-button__inner{background:#000!important;color:#fff!important;box-shadow:inset 0 0 0 1px #000!important}.header h3[data-v-e2d9c694]{margin:10px 0;text-align:center}.control-panel[data-v-e2d9c694]{display:flex;align-items:center;gap:20px;padding:10px 20px;background:#f8f9fa;border-radius:8px;margin:0 20px 10px;border:1px solid #e9ecef}.control-item[data-v-e2d9c694]{display:flex;align-items:center;gap:8px}.control-item label[data-v-e2d9c694]{font-size:14px;color:#333;font-weight:500}.max-nodes-input[data-v-e2d9c694]{width:60px;padding:4px 8px;border:1px solid #ddd;border-radius:4px;font-size:14px;text-align:center}.max-nodes-input[data-v-e2d9c694]:focus{outline:none;border-color:#409eff;box-shadow:0 0 0 2px rgba(64,158,255,.2)}.selection-status[data-v-e2d9c694]{font-size:14px;color:#666}.status-full[data-v-e2d9c694]{color:#f56c6c;font-weight:500}#viewport[data-v-e2d9c694]{width:100vw;height:100vh;overflow:hidden;position:relative}#wrapper[data-v-e2d9c694],#echart[data-v-e2d9c694]{width:100%;height:100%}.plus-button[data-v-e2d9c694]{position:absolute;width:20px;height:20px;background-color:#409eff;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;cursor:pointer;z-index:1000;box-shadow:0 2px 8px rgba(0,0,0,.3);transition:all .2s ease;user-select:none;transform:translate(-50%,-50%)}.plus-button span[data-v-e2d9c694]{line-height:1;transform:translateY(-1px)}.plus-button[data-v-e2d9c694]:hover{box-shadow:0 4px 12px rgba(0,0,0,.4)}.plus-button:hover[style*="background-color: rgb(64, 158, 255)"][data-v-e2d9c694]{background-color:#66b1ff!important}.plus-button:hover[style*="background-color: rgb(245, 108, 108)"][data-v-e2d9c694]{background-color:#f78989!important}.plus-button:hover[style*="background-color: rgb(144, 147, 153)"][data-v-e2d9c694]{background-color:#a6a9ad!important}#wrapper[data-v-e2d9c694]{position:relative}\n',document.head.appendChild(o);var E=function(e){return b("data-v-ae8090cc"),e=e(),y(),e},M={key:0,class:"body"},I={class:"info-item"},D=E((function(){return f("span",{class:"info-label"},"Node:",-1)})),P={class:"info-value"},B={class:"info-item"},F=E((function(){return f("span",{class:"info-label"},"Feature Path:",-1)})),L={class:"info-value"},R={key:0,class:"info-file_pat_"},q={class:"info-label"},U={class:"info-value"},W={key:0,style:{"margin-top":"0.5em"}},G=["onClick"],V={key:1},H={key:2,style:{"margin-top":"0.5em"}},Y=E((function(){return f("b",{style:{"margin-top":"0.5em"}},"methods: ",-1)})),Z={key:0,class:"info-file_pat_"},$={class:"info-label"},J={class:"info-value"},K={class:"info-label"},Q=["onClick"],X=x(c({__name:"nodeDetailComponent",props:{currNode:{type:Object,required:!0,default:function(){return{}}}},setup:function(e){var t=d(new Set),n=function(e){t.value.has(e)?t.value.delete(e):t.value.add(e)},o=function(e){return t.value.has(e)};return function(t,r){return e.currNode&&e.currNode.metaData?(s(),u("div",M,[f("div",I,[D,f("span",P,p(e.currNode.metaData.node),1)]),f("div",B,[F,f("span",L,p(e.currNode.metaData.feature_path),1)]),(s(!0),u(v,null,m(e.currNode.metaData.file_paths,(function(e,t){return s(),u("div",{key:t,class:"info-item"},[(s(!0),u(v,null,m(e,(function(e,t,n){return s(),u(v,{key:n},["extra"!==t?(s(),u("div",R,[f("span",q,p(t)+":",1),f("span",U,p(e),1)])):h("",!0)],64)})),128)),e.extra?(s(),u("div",W,[(s(!0),u(v,null,m(e.extra,(function(e,r,a){return s(),u(v,{key:a},["docstring"==r?(s(),u("div",{key:0,class:g(["info-docstring",{expanded:o("".concat(t,"-").concat(r))}])},[f("b",null,p(r)+": ",1),f("span",{class:"docstring-content",onClick:function(e){return n("".concat(t,"-").concat(r))}},p(e),9,G)],2)):"methods"!==r?(s(),u("p",V,[f("b",null,p(r)+": ",1),f("span",null,p(e),1)])):"methods"==r?(s(),u("div",H,[Y,(s(!0),u(v,null,m(e,(function(e,r){return s(),u("div",{key:r,style:{"margin-bottom":"0.5em"}},[(s(!0),u(v,null,m(e,(function(e,a,i){return s(),u(v,{key:i},["docstring"!==a?(s(),u("div",Z,[f("span",$,p(a)+":",1),f("span",J,p(e),1)])):"docstring"==a?(s(),u("div",{key:1,class:g(["info-docstring",{expanded:o("".concat(t,"-").concat(r,"-").concat(a))}])},[f("span",K,p(a)+":",1),f("span",{class:"docstring-content",onClick:function(e){return n("".concat(t,"-").concat(r,"-").concat(a))}},p(e),9,Q)],2)):h("",!0)],64)})),128))])})),128))])):h("",!0)],64)})),128))])):h("",!0)])})),128))])):h("",!0)}}}),[["__scopeId","data-v-ae8090cc"]]),ee=function(e){return b("data-v-ee29cc75"),e=e(),y(),e},te={class:"sidebar"},ne=ee((function(){return f("div",{class:"sidebar-header"},[f("h2",null,"ZeroRepo")],-1)})),oe={class:"sidebar-content"},re={class:"current-node-box",ref:"nodeModalRef"},ae={class:"select-node-item",style:{border:"2px solid #2b7ce9","box-shadow":"0 8px 24px rgba(43, 124, 233, 0.4)"}},ie={class:"node-header"},le={class:"node-title",style:{"padding-right":"0"}},ce=ee((function(){return f("span",{style:{color:"#2b7ce9"}},"CurrNode:  ",-1)})),de={class:"node-body"},se={style:{padding:"1em 1em 0","border-top":"1px solid #aaa","margin-top":"1em"}},ue={style:{margin:"0 0 1em"}},fe={class:"selected-nodes-box"},pe=["onClick"],ve={class:"node-body"},me=x(c({__name:"SelectedNodesPanel",props:{selectedNodeList:{type:Array,required:!0,default:[]},currNode:{type:Object,required:!0,default:function(){return{}}},maxSelectedNodes:{type:Number,required:!0,default:0}},emits:["removeSelectedNode"],setup:function(e,t){var n=t.emit,o=e,r=n,a=d(""),i=d(null),l=d({});function c(e){null!=e&&C((function(){var t=l.value[e];t&&i.value&&t.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}))}return function(t,n){var d=w("el-option"),g=w("el-select");return s(),u("div",null,[f("div",te,[ne,f("div",oe,[f("div",re,[f("div",ae,[f("div",ie,[f("h3",le,[ce,k(" "+p(e.currNode&&e.currNode.metaData?e.currNode.originalName?e.currNode.originalName+" ("+e.currNode.name+")":e.currNode.metaData.node:"节点信息"),1)])]),f("div",de,[e.currNode&&e.currNode.metaData?(s(),N(X,{key:0,currNode:e.currNode},null,8,["currNode"])):h("",!0)])])],512),f("div",se,[f("h4",ue," 已选择的节点 ("+p(e.selectedNodeList.length)+") ",1),S(g,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=function(e){return a.value=e}),filterable:"",placeholder:"Type to search yours added nodes below...",clearable:"",style:{width:"100%"},onChange:c},{default:_((function(){return[(s(!0),u(v,null,m(e.selectedNodeList,(function(e,t){var n;return s(),N(d,{key:e.id,label:(null===(n=e.metaData)||void 0===n?void 0:n.node)||e.label,value:t},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]),f("div",fe,[f("div",{ref_key:"selectedNodesScrollContainer",ref:i,class:"selected-nodes-list"},[(s(!0),u(v,null,m(e.selectedNodeList,(function(e,t){return s(),u("div",{key:t,ref_for:!0,ref:function(e){return function(e,t){e&&(l.value[t]=e)}(e,t)},class:"select-node-item"},[f("div",{class:"node-header",style:T({"border-left":"4px solid ".concat(e.selectedColor)})},[f("h3",{class:"node-title",style:T({color:e.selectedColor})},p(e.originalName?e.originalName+" ("+e.name+")":e.metaData.node),5),f("button",{class:"close-btn",onClick:function(t){return n=e.feature_path,console.log(o.selectedNodeList),void r("removeSelectedNode",n);var n}}," × ",8,pe)],4),f("div",ve,[e&&e.metaData?(s(),N(X,{key:0,currNode:e},null,8,["currNode"])):h("",!0)])])})),128))],512)])])])])}}}),[["__scopeId","data-v-ee29cc75"]]),he=function(e){return b("data-v-e2d9c694"),e=e(),y(),e},ge={class:""},be={style:{height:"100vh"}},ye={id:"viewport",style:{display:"flex"}},xe={id:"wrapper",style:{flex:"1",overflow:"hidden",height:"100%"}},we=he((function(){return f("div",{id:"echart",style:{width:"100%",height:"100%"}},null,-1)})),ke=[he((function(){return f("span",{class:"icon"},"+",-1)}))],Ne={class:"showAllNodes",style:{position:"absolute",right:"20px",top:"5px"}},Se={__name:"echart3",setup:function(e){var o=null,c={nodes:[],links:[]},p=1,v=null,m=!1,h=null,g=null,b=d([]),y=d(1e6),x=d();j(y,(function(e,t){if(console.log("最大选择数量从 ".concat(t," 变更为 ").concat(e)),b.value.length>e){var n=b.value.slice(e);b.value=b.value.slice(0,e),console.log("由于限制变更，移除了以下节点:",n),alert("由于限制变更，已移除 ".concat(n.length," 个节点"))}})),O((function(){var e=document.getElementById("echart").getBoundingClientRect().width,t=document.getElementById("echart").getBoundingClientRect().height,n=Math.min(e,t);p=Math.max(2200/n,1),g=document.getElementById("plusButton"),Q(),console.log("屏幕尺寸：",e,t,2200/n,p);var r=document.getElementById("echart");r&&(v=A(r),Promise.all([fetch("./data/webui.json").then((function(e){return e.json()})),fetch("./data/map.json").then((function(e){return e.json()}))]).then((function(e){var t=i(e,2),n=t[0],r=t[1];console.log("webui:",n),console.log("map:",r),C(n.data_flow_graph);var l=a(n,r);o=l,W(1),c=U(o),G(v)})).catch((function(e){console.error("请求失败:",e)})),z((function(){v.dispose()})))}));var N=[],C=function(e){e.forEach((function(e){var t=e.from,n=e.to;if(t&&n){var o={source:"1_"+t,target:"1_"+n,type:"rootLink",content:e,label:{show:!0,formatter:e.data_type||e.label||"",color:"#000",fontSize:9,position:"middle"},lineStyle:{color:"#000",width:1,type:"dashed",opacity:1},symbol:["circle","arrow"],symbolSize:[4,8]};N.push(o)}})),console.log(N)};var T,E,M=(E=[{name:"test1",x:T=500,y:T},{name:"test2",x:-T,y:-T},{name:"test3",x:-T,y:T},{name:"test4",x:T,y:-T}],console.log("Dddd"),E.map((function(e){return r(r({},e),{},{id:e.name,itemStyle:{opacity:0},label:{show:!1}})}))),I=["#686759","#0068B8","#62BDE4","#52E0FC","#86DCF8","#BAD7F3"],D={"Advanced Modeling Techniques":"#FF8364",Algorithms:"#00A5BF",Workflow:"#00C6A2","Data Engineering":"#A5A1F3"},P=function(e){return 0==e?5:1==e?100/p:2==e?80/p:3==e?70/p:4==e?38/p:30/p},B=function(e){return e<=1?{color:I[e%I.length],borderColor:I[e%I.length],borderWidth:.5,opacity:1}:{color:I[e%I.length],borderColor:I[e%I.length],borderWidth:.5}},F=function(e,t){return{color:1==e?"rgba(0,0,0,.1)":D[t.level1Root]||"rgba(0,0,0,.4)",width:1}},L=function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>4?arguments[4]:void 0;if(e>=5){var o=180*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/Math.PI,r=q(0,0,(null==n?void 0:n.x)+0,(null==n?void 0:n.y)+0,100,t),a=P(5);return{show:!0,position:[r.dx+a,r.dy+a],fontSize:10,color:"#333",fontWeight:"normal",align:"center",verticalAlign:"middle",rotate:o>90&&o<270?180-o:-o}}return 0==e?{fontSize:12,color:"#333",fontWeight:"normal"}:{position:"inside",fontSize:1===e?12:11,color:1==e?"#fff":"#333",verticalAlign:"middle",align:"center",fontWeight:1===e?"bold":"normal",width:200}};function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Arial",o=(R._canvas||(R._canvas=document.createElement("canvas"))).getContext("2d");return o.font="".concat(t,"px ").concat(n),o.measureText(e).width}var q=function(e,t,n,o){var r,a=arguments.length>5?arguments[5]:void 0;a.length,r=R(a)/2+25;var i=n-e,l=o-t,c=Math.atan2(l,i),d=c*(180/Math.PI);return{dx:Math.cos(c)*r,dy:Math.sin(c)*r,angleDeg:d}},U=function(e){var t=function e(t){if(!t||!1===t.visible)return null;var n=r({},t);return n.children&&Array.isArray(n.children)&&(n.children=n.children.map(e).filter((function(e){return!!e}))),n}(e);console.log("开始转换为 Graph 数据格式 treeData",t);var o=[],a=[],i=new Map;function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;function n(e){return e<=1?1:1==e?.75:2==e?.5:3==e?.3:4==e?.25:.08}if(!e.children||0===e.children.length)return n(t);var o=e.children.reduce((function(e,n){return e+c(n,t+1)}),0),r=n(t);return Math.max(o,r)}!function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;if(t&&t.name&&!1!==t.visible){var s,u=r<=1?r+"_"+(t.feature_path||t.name):r+"_"+t.id+"_"+(t.feature_path||t.name),f=function(e){return{0:0,1:110,2:210,3:310,4:420,5:500}[e]||420+40*(e-6)}(r),p=0,v=0;0===r?(p=0,v=0,s=0):(s=(l+d)/2,p=Math.cos(s)*f,v=Math.sin(s)*f);var m={id:u,name:t.name||"Unknown",originalName:t.originalName?t.originalName:null,feature_path:t.feature_path||"",level:r,metaData:t.metaData,x:p,y:v,angle:s,sectorStart:l,sectorEnd:d,fixed:!0,symbolSize:t.symbolSize||P(r),label:L(r,s,t.name||"",f,{x:p,y:v}),itemStyle:t.itemStyle||B(r),category:r};if(0!=r&&o.push(m),i.set(t.name,u),n&&r>=2&&a.push({source:n,target:u,lineStyle:t.lineStyle||F(r,t)}),t.children&&t.children.length>0){var h=t.children.map((function(e){return c(e,r+1)})),g=h.reduce((function(e,t){return e+t}),0),b=d-l;0===r&&(b=2*Math.PI);var y=l;t.children.forEach((function(t,n){var o=h[n]/g*b,a=y+o;e(t,u,r+1,y,a),y=a}))}}}(t,null,0,0,2*Math.PI),console.log("Graph 节点布局完成，节点数量:",o.length,o,a),l(t)<=2?N.forEach((function(e){e.label.show=!0})):N.forEach((function(e){e.label.show=!1}));var d=[].concat(N,a);return console.log("!!!linksResult",d),{nodes:[].concat(n(M),o),links:d}},W=function(e){o&&function t(n,o){n.visible=o<=e,n.children&&n.children.length>0&&n.children.forEach((function(e){return t(e,o+1)}))}(o,0)},G=function(e){if(c&&c.nodes&&0!==c.nodes.length){console.log("初始化 Graph 图表，节点数量:",c.nodes.length);var n={tooltip:{trigger:"item",triggerOn:"mousemove",extraCssText:"max-width: 400px; white-space: normal;",formatter:function(e){if("node"===e.dataType){var t=e.data,n="<strong>Node: </strong>".concat(t.originalName?t.originalName+" ("+t.name+")":t.name," <br/>");return t.feature_path&&(n+="<strong>Feature Path: </strong> ".concat(t.feature_path,"<br/>")),n}if("edge"===e.dataType&&e.data&&"rootLink"===e.data.type){var o="<strong>Flow Graph:</strong><br/>";return o+="<strong>From: </strong> ".concat(e.data.content.from,"<br/>"),o+="<strong>To: </strong> ".concat(e.data.content.to,"<br/>"),e.data.label&&e.data.label.formatter&&(o+="<strong>Data Type: </strong> ".concat(e.data.content.data_type,"<br/>")),o}return"edge"===e.dataType?"":e.name||""}},series:[{type:"graph",layout:"none",roam:!0,zoom:p,center:[0,0],scaleLimit:{min:.7*p,max:1.2*p},data:c.nodes,links:c.links,symbol:"circle",symbolSize:30,label:{show:!0,position:function(e){return e&&e.data&&e.data.level>=5?"right":"inside"},fontSize:function(e){return e&&e.data&&e.data.level>=5?10:12},formatter:function(e){var t=e.name||"";if(e&&e.data&&e.data.level>=3)return t;for(var n=t.split(" "),o=[],r=0;r<n.length;r++){var a=n[r];o.push(a)}return o.join("\n")}},lineStyle:{color:"source",curveness:0,width:1},animationDurationUpdate:750,animationEasingUpdate:"quinticInOut"}]};e.setOption(n),setTimeout((function(){if(c.nodes&&c.nodes.length>0){var e=c.nodes[0];Y(e)}}),100),e.on("mouseover",(function(e){if("series"===e.componentType&&"node"===e.dataType&&e.data.level>1){var t=e.data.feature_path;if(clearTimeout(X),ee===t)return;ee=t,Y(e.data)}})),e.on("mouseout",(function(e){if("series"===e.componentType&&"node"===e.dataType&&e.data.level>1){var t=e.data.feature_path;if(ee!==t)return;clearTimeout(X),X=setTimeout((function(){ee!==t||$()||(Z(),ee=null)}),200)}}));var r=null,a=e.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform();e.on("graphRoam",(function(){m=!0,console.log("拖拽/缩放开始",h);var t=e.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform(),n=!1;if(Array.isArray(t)&&6===t.length){var o=i(t,6),l=o[0],d=(o[1],o[2],o[3]),s=(o[4],o[5],i(a,6)),u=s[0],f=(s[1],s[2],s[3]);s[4],s[5];n=l!==u||d!==f}else t&&void 0!==t.zoom&&t.position&&(n=t.zoom!==a.zoom,t.position[0]!==a.position[0]||(t.position[1],a.position[1]));a=t,n&&(r&&(clearTimeout(r),r=null),r=setTimeout((function(){console.log("///// 重新设置图表选项"),e.setOption({series:[{data:c.nodes,links:c.links}]})}),300)),Z(),setTimeout((function(){m=!1,console.log("拖拽/缩放结束")}),300)})),e.on("mousedown",(function(){console.log("mousedown"),m=!0,Z()})),e.on("mouseup",(function(){console.log("mouseup"),setTimeout((function(){m=!1,console.log("鼠标操作结束")}),100)})),e.on("click",(function(n){"node"===n.dataType&&(console.log("params.data",n.data),function(e){var n=function e(n,o){if(n.feature_path===o)return n;if(n.children){var r,a=t(n.children);try{for(a.s();!(r=a.n()).done;){var i=e(r.value,o);if(i)return i}}catch(l){a.e(l)}finally{a.f()}}return null}(o,e),r=!1;if(n&&n.children){var a,i=t(n.children);try{for(i.s();!(a=i.n()).done;)if(!1===a.value.visible){r=!0;break}}catch(l){i.e(l)}finally{i.f()}n.children.forEach((function(e){if(e.visible=!e.visible,!e.visible&&e.children){var t=function(e){e.visible=!1,e.children&&e.children.forEach(t)};t(e)}}))}}(n.data.feature_path),c=U(o),e.setOption({series:[{data:c.nodes,links:c.links}]}),V(n.data),n.data.level>1&&(x.value=n.data))}))}else console.error("Graph 数据不存在或为空:",c)};function V(e){if(v&&e){console.log("@@@",e);var t=v.convertToPixel({seriesIndex:0},[e.x,e.y]),n=v.getDom(),o=n.offsetWidth,r=n.offsetHeight,a=v.getModel().getSeriesByIndex(0).option.zoom,l=80*a,c=i(t,2),d=c[0],s=c[1],u=!1;if((d<l||d>o-l||s<l||s>r-l)&&(u=!0),u){console.log("needMove");var f=e.x,p=e.y,m=Math.sqrt(f*f+p*p);if(0===m)return;var h=Math.max(0,m-200/a)/m,g=f*h,b=p*h;v.setOption({series:[{center:[g,b]}]})}}}var H=function(){if(!(h&&h.level<=1)&&h){var e=h.feature_path;if(b.value.some((function(t){return t.feature_path===e})))console.log("点击减号，移除节点:",h),b.value=b.value.filter((function(t){return t.feature_path!==e}));else{if(b.value.length>=y.value)return void alert("最多只能选择 ".concat(y.value," 个节点！"));console.log("点击加号，添加节点:",h),b.value.unshift(h),console.log("!!!!",b)}console.log("当前选择的节点列表:",b.value),Y(h)}},Y=function(e){if(g&&!m)try{var t=b.value.some((function(t){return t.feature_path===e.feature_path})),n=v.convertToPixel("series",[e.x,e.y]),o=e.symbolSize||30;console.log(n);var r=v.getModel().getSeriesByIndex(0).coordinateSystem.getRoamTransform(),a=1;Array.isArray(r)&&6===r.length?a=r[0]:r&&"number"==typeof r.zoom&&(a=r.zoom);var i=o/2*a*Math.sin(Math.PI/4),l=-o/2*a*Math.sin(Math.PI/4);g.style.left=n[0]+i+"px",g.style.top=n[1]+l+"px",g.style.display="flex",t?(g.getElementsByClassName("icon")[0].textContent="−",g.style.backgroundColor="#f56c6c",g.title="点击取消选择"):b.value.length>=y.value?(g.getElementsByClassName("icon")[0].textContent="+",g.style.backgroundColor="#909399",g.title="已达到最大选择数量 (".concat(b.value.length,"/").concat(y.value,")")):(g.getElementsByClassName("icon")[0].textContent="+",g.style.backgroundColor="#409eff",g.title="点击选择节点 (".concat(b.value.length,"/").concat(y.value,")")),h=e}catch(c){console.error("显示按钮失败:",c)}},Z=function(){clearTimeout(X),g&&(g.style.display="none"),h=null,ee=null},$=function(){return!!g&&g.matches(":hover")},J=function(e){b.value=b.value.filter((function(t){return t.feature_path!==e})),console.log("移除节点:",e),console.log("当前选择的节点列表:",b.value)},K=function(e){y.value=e,console.log("从组件更新最大选择节点数量为:",e)},Q=function(){g&&(g.addEventListener("mouseenter",(function(){console.log("鼠标进入加号按钮"),clearTimeout(X)})),g.addEventListener("mouseleave",(function(){console.log("鼠标离开加号按钮"),Z()})))},X=null,ee=null;return function(e,t){var n=w("el-button");return s(),u("div",ge,[f("div",be,[f("div",ye,[S(me,{style:{width:"20%","min-width":"300px","max-width":"600px"},selectedNodeList:b.value,maxSelectedNodes:y.value,currNode:x.value,onRemoveSelectedNode:J,onUpdateMaxNodes:K},null,8,["selectedNodeList","maxSelectedNodes","currNode"]),f("div",xe,[we,f("div",{id:"plusButton",class:"plus-button",style:{display:"none"},onClick:H},ke),f("div",Ne,[S(n,{type:"primary",onClick:t[0]||(t[0]=function(e){return W(5),c=U(o),v.setOption({series:[{data:c.nodes,links:c.links}]}),void v.setOption({series:[{center:[0,0]}]})})},{default:_((function(){return[k("展开所有")]})),_:1})])])])])])}}};e("default",x(Se,[["__scopeId","data-v-e2d9c694"]]))}}}))}();
